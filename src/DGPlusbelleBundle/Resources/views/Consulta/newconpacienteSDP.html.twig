{#{% extends 'DGPlusbelleBundle:Layout:general.html.twig' %}#}
{#{% extends 'DGPlusbelleBundle:Layout:layout.html.twig' %}#}
{% extends 'DGPlusbelleBundle:Layout:layouterp.html.twig' %}
{% block css %}
    {{parent()}}
    <link rel="stylesheet" href="{{ asset('Resources/dropzone/dropzone.css') }}">
    <link rel="stylesheet" href="{{ asset('Resources/alertifyjs/css/alertify.css') }}">
    <link rel="stylesheet" href="{{ asset('Resources/css/estilopersonalizado.css') }}">
    <link rel="stylesheet" href="{{ asset('Resources/swal/sweetalert2.min.css') }}">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.2/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/material-design-lite/1.1.0/material.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.11/css/dataTables.material.min.css">
    <style>
{#        //Posicion del boton agregar#}
        .placas>div:last-child {
            position:absolute;
        }
        
        div.placas > div:nth-child(2) > div:nth-child(2) > a{
            display: none;
        }
        
{#        //Posicion del boton agregar#}
        .placas2>div:last-child {
            position:absolute;
        }
        
        div.placas2 > div:nth-child(2) > div:nth-child(2) > a{
            display: none;
        }
        
        .addItem{
            position: absolute;
            height: 50px;
            float: right;
            margin-bottom: 50px;
            padding-bottom: 100px;
            top: -65px;
            left: -2px;
        }
        
        .addItemEst{
            position: absolute;
            height: 50px;
            float: right;
            margin-bottom: 50px;
            padding-bottom: 100px;
            top: 82px;
            left: 5px;
        }
        
        .addItem div {
            position: absolute;
        }
        
        .col-md-4{
{#            padding-top: 40px;#}
        }
        
        #dgplusbellebundle_consulta_horaInicio_hourSelectBoxItContainer, #dgplusbellebundle_consulta_horaInicio_minuteSelectBoxItContainer,
        #dgplusbellebundle_consulta_horaFin_hourSelectBoxItContainer, #dgplusbellebundle_consulta_horaFin_minuteSelectBoxItContainer{
            width:75px;
        }
        
        #dgplusbellebundle_consulta_horaInicio_hourSelectBoxItContainer,#dgplusbellebundle_consulta_horaFin_hourSelectBoxItContainer {
            float: left;
        }
        
        #dgplusbellebundle_consulta_horaInicio_minuteSelectBoxItContainer, #dgplusbellebundle_consulta_horaFin_minuteSelectBoxItContainer {
            float: right;
        }
        
        #dgplusbellebundle_consulta_horaInicio, #dgplusbellebundle_consulta_horaFin{
            width: 155px;
        }
        
        {##selectPlantillas{
            width:80%;
        }#}

        .productoConsulta{width: 50% }
        
        textarea{
            height:100px;
            resize:none;
        }

        .campos{
            width: 100%;
        }
        
        .tab-pane{
            background-color:#FFF;
        }
    </style>
{% endblock %}

{#
{% block descripcion %}
    <div class="col-md-6">
        <p class="robo" style="font-weight: 300; margin-bottom: 0px; font-size: 30px;">Consulta</p>
        <p class="robo" style="font-weight: 300; font-size: 14px; height: 40px;">Cree consultas a sus paciente en un solo lugar, de forma fácil y rápida.</p>
    </div>
{% endblock %}#}





{% block descripcion %}
    <div class="col-md-12" style="margin-bottom: 20px;">
        <p class="robo" style="font-weight: 300; margin-bottom: 0px; font-size: 27px;">Consulta</p>
    </div>
    <div class="col-md-4" style="margin-bottom: 20px;">
        <label class="robo" style="font-weight: 300; font-size: 16px; height: 25px;">Busqueda del paciente</label>
        <select id="busquedaPacienteConsulta" name="busquedaPaciente" class="form-control input-sm " data-rule-required="true" style=" width: 100%;">
            <option value="0" disabled selected>Seleccione un paciente ...</option>
        </select>
    </div>
{% endblock %}
{#
**********************************************************************************************************************************************************************************
Dentro de la div  con clase content- body
#}





{% block acciones %}
    
{% endblock acciones %}


{% block contenido -%}
    
    
    {% if flag == 0 %}    
        

            {#<div class="panel-heading">
                <p>Registrar consulta</p>
            </div>#}
        <div class="panel" data-fill-color="true">
                <div class="content-hero content-hero-lg" style="margin-bottom: 30px; border-bottom: 1px #CCC solid; min-height:50px; display:none;" id="info-Paciente" >
                    <div class="content-hero-bar">
                        <div class="row">
                            <div class="col-md-12" >
                                <hr>
                            </div>
                            <div class="col-md-12" >
                                <div class="col-md-8">
                                    <h4 class="robo media-heading text-light" id="nombrePaciente"></h4>
                                    <p class="mb-4x text-light">
                                        <span class="mr-1x" id="expediente">
                                            <i class="fa fa-clipboard"></i>
                                        </span>
                                        <span class="mr-1x" id="telefono">
                                            <i class="fa fa-phone"></i>
                                        </span>
                                        <span class="mr-1x" id="edad">
                                            <i class="fa fa-birthday-cake"></i>                                           
                                        </span>
                                        <span class="mr-1x" id="direccion">
                                            <i class="fa fa-map-marker fa-fw"></i>
                                        </span>
                                    </p>
                                </div>
                                <div class="col-md-4 robo" ></div>
                                </div>
                            </div><!-- /.media-body -->
                        </div><!-- /.cols -->
                    </div><!-- /.row -->
                </div><!-- /.content-hero-bar -->
        </div>
         
    <div class="panel-body">
        {#<select id="busquedaPacienteConsulta" style="width: 350px;" class="form-control">
                    <option value="0">Buscar paciente...</option>
        </select>#}
        <div data-init-panel="true" class=" fade in" style="margin-top:25px;">
            <ul class="nav nav-tabs" id="demo1-tabs">
              {#<li class="active"><a aria-expanded="false" href="#botabs1" data-toggle="tab">Datos generales</a></li>#}
              <li class=""><a href="#botabs1" data-toggle="tab">Datos generales</a></li>
              <li class="active"><a href="#botabs2" data-toggle="tab">Consulta</a></li>
              <li class=""><a href="#botabs3" data-toggle="tab">Signos</a></li>
              <li class=""><a href="#botabs4" data-toggle="tab">Antecedentes y alergias</a></li>
              {#<li class=""><a href="#botabs5" data-toggle="tab">Costo</a></li>#}
              <li class=""><a href="#botabs6" data-toggle="tab">Imágenes</a></li>
              <li class=""><a href="#botabs7" data-toggle="tab">Historia clínica</a></li>
              <li class=""><a href="#botabs8" data-toggle="tab">Receta médica</a></li>
              
            </ul>
            <div class="panel-body">
                <div class="tab-content">
                    <div class="tab-pane fade in" id="botabs1">
                        <p><strong></strong>
                            <div class="row" style="margin-top:20px;">
                                <div class="col-md-3">
                                    <label>
                                        Nombres
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        Apellidos
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        Telefono 1
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        Telefono 2
                                    </label>
                                </div>

                                                      
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <input id="nombresPaciente" value="" name="nombresPaciente" class="form-control input-sm"/>    
                                </div>
                                                        
                                <div class="col-md-3">
                                    <input id="apellidosPaciente" value="" name="apellidosPaciente" class="form-control input-sm"/>
                                </div>

                                <div class="col-md-3">
                                    <input id="telefono1" value="" name="telefono1" class="form-control input-sm"/>
                                </div>
                                <div class="col-md-3">
                                    <input id="telefono2" value="" name="telefono2" class="form-control input-sm"/>
                                </div>
                                
                            </div>
                        
                            <div class="row" style="margin-top:20px;">
                                <div class="col-md-3">
                                    <label>
                                        Dirección
                                    </label>
                                </div>      
                                <div class="col-md-3">
                                    <label>
                                        Correo
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        DUI
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        Estado civil
                                    </label>
                                </div>
                                
                            </div>
                                
                            <div class="row">
                                <div class="col-md-3">
                                    <input id="direccion" value="" name="direccion" class="form-control input-sm"/>
                                </div>
                                
                                <div class="col-md-3">
                                    <input id="correo" value="" name="correo" class="form-control input-sm"/>
                                </div>
                                
                                <div class="col-md-3">
                                    <input id="dui" value="" name="dui" class="form-control input-sm"/>
                                </div>                        
                                
                                <div class="col-md-3">
                                    <select id="estadoCivil" name="estadoCivil" class="col-md-12 form-control input-sm estadocivilPaciente form-control" style="width:100%;">
                                        <option {% if paciente.estadoCivil== ''%} selected {% endif %} value="">Seleccione estado civil...</option>            
                                        <option {% if paciente.estadoCivil== 'Soltero/a' %} selected {% endif %} value="Soltero/a">Soltero/a</option>            
                                        <option {% if paciente.estadoCivil== 'Casado/a' %} selected {% endif %} value="Casado/a">Casado/a</option>            
                                        <option {% if paciente.estadoCivil== 'Divorciado/a' %} selected {% endif %} value="Divorciado/a">Divorciado/a</option>            
                                        <option {% if paciente.estadoCivil== 'Acompañado/a'%} selected {% endif %} value="Acompañado/a">Acompañado/a</option>            
                                        <option {% if paciente.estadoCivil== 'Viudo/a'%} selected {% endif %} value="Viudo/a">Viudo/a</option>
                                    </select>
                                </div>
                            
                                                             
                            </div>
                                    
                                    
                            <div class="row" style="margin-top:20px;">
                                <div class="col-md-3">
                                    <label>
                                        Sexo
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        Ocupación
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        Lugar de trabajo
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        Fecha de nacimiento
                                    </label>
                                </div>
                                
                            </div>
                                    
                                    
                            <div class="row">
                                <div class="col-md-3">
                                    <select id="sexo" name="sexo" class="form-control input-sm" style="width:100%;">
                                        <option {% if paciente.sexo== ''%} selected {% endif %} value="">Seleccione sexo...</option>            
                                        <option {% if paciente.sexo== 'm' or paciente.sexo=='M' %} selected {% endif %} value="M">Masculino</option>            
                                        <option {% if paciente.sexo== 'f' or paciente.sexo=='F' %} selected {% endif %} value="F">Femenino</option>            
                                    </select>
                                </div>   
                                <div class="col-md-3">
                                    <input id="ocupacion" value="{{paciente.ocupacion}}" name="ocupacion" class="form-control input-sm"/>
                                </div>
                                
                                <div class="col-md-3">
                                    <input id="lugarTrabajo" value="{{paciente.lugarTRabajo}}" name="lugarTrabajo" class="form-control input-sm"/>
                                </div>                        
                                
                                <div class="col-md-3">
                                    <input id="fechaNacimiento" value="{{paciente.fechaNacimiento|date('d-m-Y')}}" name="fechaNacimiento" class="form-control calZebra input-sm"/>
                                </div>
                                                    
                            </div>
                                
                            <div class="row" style="margin-top:20px;">
                                <div class="col-md-3">
                                    <label>
                                        Referido por
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        En caso de emergencia llamar a
                                    </label>
                                </div>
                                <div class="col-md-3">
                                    <label>
                                        Al teléfono
                                    </label>
                                </div>
                                
                            </div>
                                
                            <div class="row">
                                <div class="col-md-3">
                                    <input id="referidoPor" value="{{paciente.referidoPor}}" name="referidoPor" class="form-control input-sm"/>
                                </div>
                                <div class="col-md-3">
                                    <input id="llamarA" value="{{paciente.personaEmergencia }}" name="llamarA" class="form-control input-sm"/>
                                </div>
                                <div class="col-md-3">
                                    <input id="telefonoEmergencia" value="{{paciente.telefonoEmergencia }}" name="telefonoEmergencia" class="form-control input-sm"/>
                                </div>
                            </div>
                                    
                            <div class="row" style="margin-top:10px;">
                                <div class="col-md-12">
                                    <hr>
                                </div>
                            </div>

                            <div class="row  pull-right" style="margin-top:10px;">
                                <div class="col-md-12">
                                    <div class="form-grouphide col-sm-12">
                                        <button type="submit" id="guardarNuevoDatosGenerales" name="dgplusbellebundle_consulta[submit]" class="btn btn-primary btn-xs btn btn">Guardar</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <input type="hidden" id="idPaciente" value="{{paciente.id}}" name="idPaciente" class="form-control input-sm"/>                                    
                            </div>
                      </p>
                    </div>

                    <div class="tab-pane active fade in" id="botabs2">
                      <p>
                            <div class="row">
                                <div class="col-md-12">                                    
                                    <div class="row" style="margin-top:20px;">
                                        <div class="col-md-3">
                                            <label>
                                                Médico
                                            </label>
                                        </div>
                                        <div class="col-md-3">
                                            <label>
                                                Costo de consulta
                                            </label>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <label>
                                                Tipo consulta
                                            </label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-3">
                                            <select id="medico_consulta" name="tratamiento" class="form-control input-sm">
{#                                                <option value="0" selected>Seleccione un médico...</option>#}
                                                {% for empleado in empleados %}
{#                                                    <option value="{{empleado.id}}" {% if consulta.empleado!=null and consulta.tipoConsulta!=null and consulta.id!=null and empleado.id==consulta.empleado.id %} selected {% endif %}>{{empleado.persona.nombres}} {{empleado.persona.apellidos}}</option>#}
                                                        <option value="{{empleado.id}}" {% if consulta.empleado is not null and empleado.id==consulta.empleado.id %} selected {% endif %}>{{empleado.persona.nombres}} {{empleado.persona.apellidos}}</option>
                                                {% endfor %}
                                            </select>  
                                        </div>
                                        <div class="col-md-3">
                                            <input type="text" id="costoConsulta" class="form-control" placeholder="$"/>
                                        </div>
                                        {#<div class="col-md-3">
                                            <select id="tratamiento_consulta" name="tratamiento" class="form-control input-sm">
                                                <option value="0" selected>Seleccione un tratamiento...</option>
                                            </select>  
                                        </div>#}
                                        
                                        <div class="col-md-6">
                                            <select id="tipo_consulta" class="form-control input-sm">
                                                <option value="0" selected>Seleccione un tipo de consulta...</option>
                                                {%for tipo in tipoConsulta %}
                                                    <option value="{{tipo.id}}" {% if consulta.tipoConsulta!=null and consulta.id!=null and tipo.id==consulta.tipoConsulta.id %} selected {% endif %}>{{tipo.nombre}}</option>
                                                {% endfor %}
                                            </select>
                                        </div>                                        
                                    </div>
                                    
                                    <div class="row" style="margin-top:20px;">
                                        <div class="col-md-6">
                                            <label>
                                                Observación
                                            </label>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <label>
                                                Sucursal
                                            </label>
                                        </div>                                        
                                    </div>
                                    <div class="row">                                                                               
                                        <div class="col-md-6">
                                            <textarea class="col-md-12 editorArea form-control" id="observacionConsulta">{{consulta.observacion}}</textarea>
                                        </div>
                                        
                                        <div class="col-md-6">
                                            <select id="sucursal_consulta" class="form-control input-sm">
{#                                                <option value="0" selected>Seleccione una sucursal...</option>#}
                                                {% for sucursal in sucursales %}
                                                    {% if consulta.sucursal is not null %}
                                                        <option value="{{sucursal.id}}" {% if consulta.id!=null and sucursal.id==consulta.sucursal.id %} selected {% endif %}>{{sucursal.nombre}}</option>
                                                    {% else %}
                                                        {% if loop.index == 0 %}
                                                            <option selected value="{{sucursal.id}}" >{{sucursal.nombre}}</option>
                                                        {% else %}
                                                            <option value="{{sucursal.id}}" >{{sucursal.nombre}}</option>
                                                        {%endif %}
                                                    {% endif %}
                                                    
                                                {% endfor %}
                                            </select>
                                        </div>
                                                                                
                                    </div>
                                    
                                    <div class="row" style="display:none;margin-top:20px;">
                                        <div class="col-md-12">
                                            <label>
                                                Receta médica
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="row" style="margin-top:10px;height: 100px; display:none;">
                                        <div class="col-md-2">
                                            <input id="dgplusbellebundle_consulta_registraReceta_0" name="dgplusbellebundle_consulta[registraReceta]" required="required" value="1" type="radio"> Sí
                                            <br>
                                            <input id="dgplusbellebundle_consulta_registraReceta_1" name="dgplusbellebundle_consulta[registraReceta]" required="required" value="0" type="radio"> No
                                        </div>
                                        <div class="col-md-10">
                                            <textarea id="textareaReceta" class="form-control input-sm col-md-8 editorArea" placeholder="Receta médica"></textarea>
                                        </div>
                                    </div>
                                    
                                    <div class="row" style="margin-top:10px;">
                                        <div class="col-md-12">
                                            <hr>
                                        </div>
                                    </div>
                                    
                                    <div class="row  pull-right" style="margin-top:10px;">
                                        <div class="col-md-12">
                                            <div class="form-grouphide col-sm-12">
                                                <a class="btn btn-default btn-xs" id="cancelarNuevoConsulta">Cancelar</a>
                                                <button type="submit" id="guardarNuevoConsulta" name="dgplusbellebundle_consulta[submit]" class="btn btn-primary btn-xs btn btn">Guardar</button>
                                            </div>
                                        </div>
                                    </div>                                                                                    
                                </div>                                                                
                            </div>
                      
                      
                      </p>
                    </div>
                    <div class="tab-pane fade in" id="botabs3">
                        <p>
                            
                            <div class="row">
                                
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label>
                                                Peso (Kg)
                                            </label>
                                        </div>
                                        <div class="col-md-4">
                                            <label>
                                                Talla (cm)
                                            </label>
                                        </div>
                                        <div class="col-md-4">
                                            <label>
                                                Frecuencia respiratoria (x minuto)
                                            </label>
                                        </div>
                                        
                                        <div class="clearfix"></div>
                                        <div class="col-md-4">
                                            <input id="pesoPaciente" value="{{signos.peso}}" name="peso_paciente" class="form-control input-sm form-control"/>
                                        </div>
                                        <div class="col-md-4">
                                            <input id="tallaPaciente" value="{{signos.talla}}" name="peso_paciente" class="form-control input-sm form-control"/>
                                        </div>
                                        <div class="col-md-4">
                                            <input id="frecRespiratoria" value="{{signos.frecRespiratoria}}" name="peso_paciente" class="form-control input-sm form-control"/>
                                        </div>
                                    </div>
                                    
                                    <div class="row" style="margin-top:20px;">
                                        <div class="col-md-4">
                                            <label>
                                                Presión arterial (mmHg)
                                            </label>
                                        </div>
                                        <div class="col-md-4">
                                            <label>
                                                Temperatura (°C)
                                            </label>
                                        </div>
                                        <div class="col-md-4">
                                            <label>
                                                Frecuencia cardiaca (x minuto)
                                            </label>
                                        </div>
                                        
                                        <div class="clearfix"></div>
                                        <div class="col-md-4">
                                            <div class="col-md-5">
                                                <input id="presionSistolica" value="{{signos.presionSistolica}}" name="presionSistolica" class="form-control input-sm form-control"/>
                                            </div>
                                            <div class="col-md-2"><label style="font-size:1.3em;">/</label></div>
                                            <div class="col-md-5">
                                                <input id="presionDiastolica" value="{{signos.presionDiastolica}}" name="presionDiastolica" class="form-control input-sm form-control"/>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <input id="temperaturaPaciente" value="{{signos.temperatura}}" name="temperaturaPaciente" class="form-control input-sm form-control"/>
                                        </div>
                                        <div class="col-md-4">
                                            <input id="frecCardiaca" value="{{signos.frecCardiaca}}" name="frecCardiaca" class="form-control input-sm form-control"/>
                                        </div>
                                    </div>
                                    
                                    <div class="row" style="margin-top:10px;">
                                        <div class="col-md-12">
                                            <hr>
                                        </div>
                                    </div>
                                    
                                    <div class="row pull-right" style="margin-top:10px;">
                                        <div class="col-md-12">
                                            <div class="form-grouphide col-sm-12">
                                                <button type="submit" id="guardarSignosConsulta" name="dgplusbellebundle_consulta[submit]" class="btn btn-primary btn-xs btn btn">Guardar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </p>
                    </div>
                    <div class="tab-pane fade in" id="botabs4">
                        <p>
                            
                        </p>
                        <div class="row">
                            <div class="col-md-4">
                                <label>Patológicos</label>
                            </div>
                            <div class="col-md-4">
                                <label>Familiares</label>
                            </div>
                            <div class="col-md-4">
                                <label>Alergias</label>
                            </div>
                        </div>
                        <div class="row" style="margin-top:20px;">
                            <div class="col-md-4">
                                <textarea maxlength="400" style="height:100px;" id="antecedentesPatologicos" class="form-control">{{paciente.patologicos}}</textarea>
                            </div>
                            <div class="col-md-4">
                                <textarea maxlength="400" style="height:100px;" id="antecedentesFamiliares" class="form-control">{{paciente.familiares}}</textarea>
                            </div>
                            <div class="col-md-4">
                                <textarea maxlength="400" style="height:100px;" id="antecedentesAlergias" class="form-control">{{paciente.alergias}}</textarea>
                            </div>
                        </div>
                            
                        <div class="row" style="margin-top:10px;">
                            <div class="col-md-12">
                                <hr>
                            </div>
                        </div>

                        <div class="row  pull-right" style="margin-top:10px;">
                            <div class="col-md-12">
                                <div class="form-grouphide col-sm-12">
                                    {#<a class="btn btn-default btn-xs" id="cancelarNuevoConsulta">Cancelar</a>#}
                                    <button type="submit" id="guardarAntecedentes" name="dgplusbellebundle_antecedentes[submit]" class="btn btn-primary btn-xs btn btn">Guardar</button>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    <div class="tab-pane fade in" id="botabs5">
                        <p><strong></strong>
                            <div class="row">
                                <div class="col-md-4">
                                    <label>Costo de consulta</label>
                                </div>
                            </div>
                            <div class="row" style="margin-top:20px;">
                                <div class="col-md-4">
                                    <input type="text" id="costoConsulta" value="{{consulta.costoConsulta}}" class="form-control" placeholder="$"/>
                                    {#<input id="costoConsultaAlergias" class="form-control"/>#}
                                </div>
                            </div>
                                <div class="row" style="margin-top:10px;">
                                <div class="col-md-12">
                                    <hr>
                                </div>
                            </div>

                            <div class="row  pull-right" style="margin-top:10px;">
                                <div class="col-md-12">
                                    <div class="form-grouphide col-sm-12">
                                        {#<a class="btn btn-default btn-xs" id="cancelarNuevoConsulta">Cancelar</a>#}
                                        <button type="submit" id="guardarCostoConsulta" name="dgplusbellebundle_antecedentes[submit]" class="btn btn-primary btn-xs btn btn">Guardar</button>
                                    </div>
                                </div>
                            </div>
                        </p>
                    </div>
                    <div class="tab-pane fade in" id="botabs6">
                        <p>                            
                            
                            <div class="imagenMensaje row" style="margin-top:20px;">
                                <strong>Subir imagen</strong>
                                <p>Debe ingresar una consulta antes</p>
                            </div>
                            <div class="imagenContent hidden row" style="margin-top:20px;">
                                <strong>Subir imagen</strong>
                                <div class="col-md-12">
                                    {#<form id="formImagen" role="form" enctype="multipart/form-data" method="post" class="dropzone">
                                        <input id="file-input" required type="file" name="file[]" multiple>
                                        <input type="text" id="idConsulta" value="{% if consulta.id is null %}{%else%}{{consulta.id}}{%endif%}" name="idConsulta" class="hidden form-control input-sm"/>
                                    </form>#}
                                    
                                    <form class="dropzone" id="formImagen" role="form" enctype="multipart/form-data" method="post" action="/lpbsistema/app_dev.php/admin/consulta/ingresar_foto_persona/get?id={{consulta.id}}">
                                        <div class="fallback">
                                            <input name="file[]" type="file" multiple required id="file-input"/>
                                        </div>
                                        <input type="text" id="idConsulta" value="{% if consulta.id is null %}{%else%}{{consulta.id}}{%endif%}" name="idConsulta" class="hidden form-control input-sm"/>
                                    </form>
                                    
                                    
                                    {#<form action="#" id="formImagen" enctype="multipart/form-data"  method="post">
                                        <div class="form-group">
                                          <div class="fileinput fileinput-new input-group" data-provides="fileinput">
                                            <div class="form-control" data-trigger="fileinput"><i class="glyphicon glyphicon-file fileinput-exists"></i> <span class="fileinput-filename"></span></div>
                                            <div class="input-group-btn">
                                              <span class="btn btn-default btn-file"><span class="fileinput-new">Select file</span><span class="fileinput-exists">Change</span><input name="..." type="file"></span>
                                              <a href="#" class="btn btn-danger fileinput-exists" data-dismiss="fileinput">Remove</a>
                                            </div>
                                          </div><!-- /.fileinput -->
                                        </div><!-- /.form-group -->
                                    </form>#}
                                </div>
                            </div>
                            
                            <div class="row imagenContent hidden" style="margin-top:20px;">
                                <strong style="margin-top:80px;">Archivos adjuntos</strong>
                                <div class="col-md-12" id="listadoImagenes">
                                    {% for imagen in archivos %}
                                        <div class="col-md-2" style="margin-top:10px;">
                                            <a class="verImagen" href="{{ asset('Photos/Tmp/')}}{{imagen.foto}}">
                                            <img style="width:100%;" src="{{ asset('Photos/Tmp/')}}{{imagen.foto}}"></a>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                            
                            <div class="row imagenContent hidden" style="margin-top:10px;">
                                <div class="col-md-12">
                                    <hr>
                                </div>
                            </div>

                        <div class="row pull-right" style="margin-top:10px;">
                            <div class="col-md-12">
                                <div class="form-grouphide col-sm-12">
                                    {#<a class="btn btn-default btn-xs" id="cancelarNuevoConsulta">Cancelar</a>#}
                                    {#<button type="submit" id="guardarImagenes" name="dgplusbellebundle_antecedentes[submit]" class="btn btn-primary btn-xs btn btn">Guardar</button>#}
                                </div>
                            </div>
                        </div>
                        </p>
                    </div>
                                    
                    <div class="tab-pane fade in" id="botabs7">
                        <p>
                            <strong></strong>
                            {%if existePlantilla == false %}
                            <div id="planOpciones">
                                <input id="selectPlantilla0" class="selectPlantilla" type="radio" name="plant" value="0"> Sonodigest<br>
                                <input id="selectPlantilla1" class="selectPlantilla" type="radio" name="plant" value="1"> La plus belle<br>
                            </div>
                            <div class="LPB" style="display:none; margin-top: 40px;">
                                
                                <div class="row" style="margin-top:10px;">
                                    <div class="col-md-2 opcionHistorial">
                                        Seleccione historial clínico:
                                    </div>

                                    <div class="col-md-10 opcionHistorial">
                                        <select id="dgplusbellebundle_consulta_estetica" class="col-md-8 form-control input-sm" style="width:50%" >
                                            {% for plantilla in plantillasEstetica %}
                                                <option value="{{plantilla.id}}">
                                                    {{plantilla.tipoEstetica|upper}}
                                                </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="clearfix"></div>
                                    <div class="col-md-12" style="margin-top:20px; display:none;" id="idPlantillaEst">
                                        <i class="fa fa-file-pdf-o" style="margin-right:10px;"></i><a id="esteticaPrevPDF" style="cursor:pointer;">Generar PDF</a>
{#                                        <hr>#}
                                    </div>

                                    <div class="row" style="margin-top:10px;">
                                        <div class="col-md-12">
                                            <hr>
                                        </div>
                                    </div>

                                    <div class="row  pull-right">
                                        <div class="col-md-12">
                                            <div class="form-grouphide col-sm-12">
                                                {#<a class="btn btn-default btn-xs" id="cancelarNuevoConsulta">Cancelar</a>#}
                                                <button type="submit" id="guardarPlantilla" name="dgplusbellebundle_antecedentes[submit]" class="btn btn-primary btn-xs btn btn" style="color: #FFF">Guardar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                            {% else %}  
                                <div class="row" style="margin-bottom: 20px;">
                                {% if tipoPlantilla == 1 %}
                                    <div class="col-md-2">
                                        <p>Sonodigest</p>
                                    </div>  
                                    <div class="col-md-6">
                                        <p><strong>Historia clinica: </strong>{{ tienePlantilla[0].detallePlantilla.plantilla }}</p>
                                        </div>   
                                    
                                {% else %}
                                    <div class="col-md-2">
                                        <p>La Plus Belle</p>
                                    </div>   
                                
                                    {% if tipoPlantilla == 2 %}
                                        <div class="col-md-4">
                                            <p>Historia clinica de consulta de botox</p>
                                        </div>   
                                    {% elseif tipoPlantilla == 3 %}
                                        <div class="col-md-4">
                                            <p>Historia clinica de corporal</p>
                                        </div> 
                                    {% elseif tipoPlantilla == 4 %}
                                        <div class="col-md-4">
                                            <p>Historia clinica de facial</p>
                                        </div> 
                                    {% endif %}
                                {% endif %}
                                </div>
                                <div class="clearfix"></div>
                                {% if consulta.sucursal is not null%}
                                    <i class="fa fa-file-pdf-o"></i><a class="generarPDF" href="{{path(ruta,{botox:botox,valores:valores,id:consulta.id,paciente:paciente.id,sucursal:consulta.sucursal.id,estetica:estetica,corporal:corporal})}}"> Ver historia clinica</a>
                                    <hr>
                                {% else %}
                                    <i class="fa fa-file-pdf-o"></i><a class="generarPDF" href="{{path(ruta,{botox:botox,valores:valores,id:consulta.id,paciente:paciente.id,sucursal:8  ,estetica:estetica,corporal:corporal})}}"> Ver historia clinica</a>
                                    <hr>
                                {% endif %}
                                
                                <div class="row  pull-right" style="margin-top:10px;">
                                    <div class="col-md-12">
                                        <div class="form-grouphide col-sm-12">
                                            {#<a class="btn btn-default btn-xs" id="cancelarNuevoConsulta">Cancelar</a>#}
                                            <button type="submit" id="editarPlantilla" name="dgplusbellebundle_editarPlantilla[submit]" class="btn btn-primary btn-xs btn btn" style="color: #FFF">Actualizar</button>
                                        </div>
                                    </div>
                                            
                                </div>
                                <div class="clearfix"></div>
                                {# Si el tipo de plantilla a editar es de Botox #}    
                                {% if tipoPlantilla == 2 %}
                                    <div class="row  pull-right">            
                                        <div class="col-md-12" style="margin-top:30px;">
                                            <div class="form-grouphide col-sm-12">
                                                <div id="comparativoBotox" class="comparativoBotox">
                                                    <a id="nuevoUrlBotox" style="color: blue;">Nuevo registro de detalle de consulta</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>
                                    <hr>

                                    {% for key, row in tienePlantilla %}
                                        <div class="col-mod-12 botox-{{ key }}" style="margin-bottom: 15px;">
                                            <div class="row">
                                                {% if key != 0 %}
                                                    <div id="comparativoBotox" class="text-right comparativoBotox-{{ key }}">
                                                        <a id="borrarUrlBotox-{{ key }}" class="borrarRegistro" style="color: red;">Eliminar registro</a>
                                                        <hr>
                                                    </div>
                                                {% endif %}    
                                                <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                    <div>
                                                        <label>
                                                            <p style="color: #646473; font-size: 13px;">Area a inyectar</p>
                                                        </label>
                                                    </div>
                                                    <input id="area_inyectar" class="form-control cbotox" type="text" name="botox[{{ key }}]['area_inyectar']" value="{{ row.areaInyectar }}">

                                                </div>
                                                <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                    <div>
                                                        <label>
                                                            <p style="color: #646473; font-size: 13px;">Unidades</p>
                                                        </label>
                                                    </div>
                                                    <input id="unidades" class="form-control cbotox" type="text" name="botox[{{ key }}]['unidades']" value="{{ row.unidades }}">

                                                </div>  
                                                <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                    <div>
                                                        <label>
                                                            <p style="color: #646473; font-size: 13px;">Fecha de caducidad</p>
                                                        </label>
                                                    </div>
                                                    <input id="caducidad-{{ key }}" class="form-control cbotox calZebra {#caducidad#}" type="text" name="botox[{{ key }}]['caducidad']" value="{{ row.fechaCaducidad|date('d-m-Y') }}">

                                                </div>    
                                                <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                    <div>
                                                        <label>
                                                            <p style="color: #646473; font-size: 13px;">lote No.</p>
                                                        </label>
                                                    </div>
                                                    <input id="lote" class="form-control cbotox" type="text" name="botox[{{ key }}]['lote']" value="{{ row.lote }}">
                                                </div>     
                                                <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                    <div>
                                                        <label>
                                                            <p style="color: #646473; font-size: 13px;">Marca del producto</p>
                                                        </label>
                                                    </div>
                                                    <input id="marca_producto" class="form-control cbotox" type="text" name="botox[{{ key }}]['marca_producto']" value="{{ row.marcaProducto }}">
                                                </div>
                                                <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                    <div>
                                                        <label>
                                                            <p style="color: #646473; font-size: 13px;">No. Aplicacion</p>
                                                        </label>
                                                    </div>
                                                    <input id="num_aplicacion" class="form-control cbotox" type="text" name="botox[{{ key }}]['num_aplicacion']" value="{{ row.numAplicacion }}">
                                                </div>
                                                <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                    <div>
                                                        <label>
                                                            <p style="color: #646473; font-size: 13px;">Valor</p>
                                                        </label>
                                                    </div>
                                                    <input id="botox_valor" class="form-control cbotox" type="text" name="botox[{{ key }}]['valor']" value="{{ row.valor }}">
                                                </div>
                                                {% if row.recomendaciones %}
                                                    <div class="form-group col-md-8" style="margin-bottom: 10px;">
                                                        <div>
                                                            <label>
                                                                <p style="color: #646473; font-size: 13px;">Recomendaciones</p>
                                                            </label>
                                                        </div>
                                                        <textarea id="botox_recomendaciones" class="form-control cbotox" type="text" name="botox[0][recomendaciones]">{{ row.recomendaciones }}</textarea>
                                                    </div>
                                                {% endif %}    
                                            </div>

                                        </div>

                                    {% endfor %}
                                {# Si el tipo de plantilla a editar es de Composicion corporal #}    
                                {% elseif tipoPlantilla == 3 %}
                                    <div class="row  pull-right">            
                                        <div class="col-md-12" style="margin-top:30px;">
                                            <div class="form-grouphide col-sm-12">
                                                <div id="comparativoCorp">
                                                    <a id="urlComparativoCrp" style="color: blue;">Ver comparativo</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>
                                    <hr>
                                    <div class="col-md-12 corporal" style="margin-bottom: 15px;" {#data-bvalidator="required,required"#}>
                                        <div class="row">
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">Peso</p>
                                                    </label>
                                                </div>
                                                <input id="peso" class="form-control corporall" type="text" name="corporal[peso]" data-bvalidator="required,required" value="{{ tienePlantilla[0].peso }}">
                                            </div>
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">Grasa corporal</p>
                                                    </label>
                                                </div>
                                                <input id="grasa_corporal" class="form-control corporall" type="text" name="corporal[grasa_corporal]" data-bvalidator="required,required" value="{{ tienePlantilla[0].grasaCorporal }}">
                                            </div>
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">Agua corporal</p>
                                                    </label>
                                                </div>
                                                <input id="agua_corporal" class="form-control corporall" type="text" name="corporal[agua_corporal]" data-bvalidator="required,required" value="{{ tienePlantilla[0].aguaCorporal }}">
                                            </div>
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">Masa musculo</p>
                                                    </label>
                                                </div>
                                                <input id="masa_musculo" class="form-control corporall" type="text" name="corporal[masa_musculo]" data-bvalidator="required,required" value="{{ tienePlantilla[0].masaMusculo }}">
                                            </div>
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">Valoracion Fisica</p>
                                                    </label>
                                                </div>
                                                <input id="valoracion_fisica" class="form-control corporall" type="text" name="corporal[valoracion_fisica]" data-bvalidator="required,required" value="{{ tienePlantilla[0].valoracionFisica }}">
                                            </div>
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">DCI / BMR</p>
                                                    </label>
                                                </div>
                                                <input id="dci_bmr" class="form-control corporall" type="text" name="corporal[dci_bmr]" data-bvalidator="required,required" value="{{ tienePlantilla[0].dciBmr }}">
                                            </div>
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">Edad metabolica</p>
                                                    </label>
                                                </div>
                                                <input id="edad_metabolica" class="form-control corporall" type="text" name="corporal[edad_metabolica]" data-bvalidator="required,required" value="{{ tienePlantilla[0].edadMetabolica }}">
                                            </div>
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">Masa Osea</p>
                                                    </label>
                                                </div>
                                                <input id="masa_osea" class="form-control corporall" type="text" name="corporal[masa_osea]" data-bvalidator="required,required" value="{{ tienePlantilla[0].masaOsea }}">
                                            </div>
                                            <div class="form-group col-md-4" style="margin-bottom: 10px;">
                                                <div>
                                                    <label>
                                                        <p style="color: #646473; font-size: 13px;">Grasa visceral</p>
                                                    </label>
                                                </div>
                                                <input id="grasa_visceral" class="form-control corporall" type="text" name="corporal[grasa_visceral]" data-bvalidator="required,required" value="{{ tienePlantilla[0].grasaVisceral }}">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div> 
                                    <div class="parametro col-md-6" style="margin-top: 15px;">
                                        <div class="form-group" style="margin-bottom: 10px;">
                                           <div>
                                               <label>
                                                   <p style="color: #646473; font-size: 13px;">Tratamiento</p>
                                               </label>
                                            </div>
                                            {% for tratamiento in parametros if tratamiento.id == 4 %}
                                                <div>
                                                    <div>
                                                        <div class="checkbox col-md-2" style="margin-top: -10px;">
                                                            <input id="{{ tratamiento.opcid }}" class="form-control classCorporal" type="checkbox" name="{{ tratamiento.opcnom }}" value="{{ tratamiento.opcid }}" {% for valor in valores if valor == tratamiento.opcid %} checked {% endfor %}>
                                                        </div>
                                                        <div class="row">{{ tratamiento.opcnom }}</div>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    <div class="parametro col-md-6" style="margin-top: 15px;">
                                        <div class="form-group" style="margin-bottom: 10px;">
                                            <div>
                                               <label>
                                                   <p style="color: #646473; font-size: 13px;">Sugerencia</p>
                                               </label>
                                            </div>
                                            {% for tratamiento in parametros if tratamiento.id == 5 %}
                                                <div>
                                                    <div>
                                                        <div class="checkbox col-md-2" style="margin-top: -10px;">
                                                            <input id="{{ tratamiento.opcid }}" class="form-control classCorporal" type="checkbox" name="{{ tratamiento.opcnom }}" value="{{ tratamiento.opcid }}" {% for valor in valores if valor == tratamiento.opcid %} checked {% endfor %}>
                                                        </div>
                                                        <div class="row">{{ tratamiento.opcnom }}</div>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                {# Si el tipo de plantilla a editar es de Facial #}        
                                {% elseif tipoPlantilla == 4 %}    
                                    <div class="clearfix"></div> 
                                    <div class="parametro col-md-4" style="margin-top: 15px;">
                                        <div class="form-group" style="margin-bottom: 10px;">
                                           <div>
                                               <label>
                                                   <p style="color: #646473; font-size: 13px;">Tipo de piel</p>
                                               </label>
                                            </div>
                                            {% for tratamiento in parametros if tratamiento.id == 1 %}
                                                <div>
                                                    <div>
                                                        <div class="checkbox col-md-2" style="margin-top: -10px;">
                                                            <input id="{{ tratamiento.opcid }}" class="form-control classCorporal" type="checkbox" name="{{ tratamiento.opcnom }}" value="{{ tratamiento.opcid }}" {% for valor in valores if valor == tratamiento.opcid %} checked {% endfor %}>
                                                        </div>
                                                        <div class="row">{{ tratamiento.opcnom }}</div>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    <div class="parametro col-md-4" style="margin-top: 15px;">
                                        <div class="form-group" style="margin-bottom: 10px;">
                                            <div>
                                               <label>
                                                   <p style="color: #646473; font-size: 13px;">Necesidades observadas</p>
                                               </label>
                                            </div>
                                            {% for tratamiento in parametros if tratamiento.id == 2 %}
                                                <div>
                                                    <div>
                                                        <div class="checkbox col-md-2" style="margin-top: -10px;">
                                                            <input id="{{ tratamiento.opcid }}" class="form-control classCorporal" type="checkbox" name="{{ tratamiento.opcnom }}" value="{{ tratamiento.opcid }}" {% for valor in valores if valor == tratamiento.opcid %} checked {% endfor %}>
                                                        </div>
                                                        <div class="row">{{ tratamiento.opcnom }}</div>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                    <div class="parametro col-md-4" style="margin-top: 15px;">
                                        <div class="form-group" style="margin-bottom: 10px;">
                                            <div>
                                               <label>
                                                   <p style="color: #646473; font-size: 13px;">Recomendaciones</p>
                                               </label>
                                            </div>
                                            {% for tratamiento in parametros if tratamiento.id == 3 %}
                                                <div>
                                                    <div>
                                                        <div class="checkbox col-md-2" style="margin-top: -10px;">
                                                            <input id="{{ tratamiento.opcid }}" class="form-control classCorporal" type="checkbox" name="{{ tratamiento.opcnom }}" value="{{ tratamiento.opcid }}" {% for valor in valores if valor == tratamiento.opcid %} checked {% endfor %}>
                                                        </div>
                                                        <div class="row">{{ tratamiento.opcnom }}</div>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                {% elseif tipoPlantilla == 1 %}        
                                        <div id="camposPlantilla" class="camposPlantilla" style="margin-top: 30px">
                                            <div class="row">
                                                <div class="col-md-12"></div>
                                                <div id="campos" class="col-md-12 campos">
                                                    {% for key, row in tienePlantilla %}
                                                        <div class="parametro col-md-11">
                                                            <label>
                                                                <p style="color: #646473; font-size: 13px; font-weight: 700;">{{ row.detallePlantilla.nombre }}</p>
                                                            </label>
                                                            <textarea id="{{ row.detallePlantilla.id }}" class="form-control classPlantilla" type="text" placeholder="{{ row.detallePlantilla.nombre }}" style="margin-bottom: 5px;resize:vertical;height:150px;" name="{{ row.detallePlantilla.nombre }}" data-bvalidator="required,required">{{ row.valorDetalle }}</textarea>
                                                        </div>
                                                    {% endfor %}    
                                                </div>
                                            </div>
                                        </div>
                                {% endif %}    
                            {% endif %}
                            {%if existePlantilla == false %}
                            <div class="SD" style="display:none; margin-top: 40px;">
                                
                                    <div class="row" style="margin-top:10px;">
                                        <div class="col-md-2 labelPlantilla" >
                                            Seleccione historial clínico:
                                        </div>

                                        <div class="col-md-10">
                                            <select id="dgplusbellebundle_consulta_plantilla" class="col-md-8 form-control input-sm" style="width:50%" >
                                                {% for plantilla in plantillas %}
                                                    <option value="{{plantilla.id}}">
                                                        {{plantilla.nombre|upper}}
                                                    </option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="clearfix"></div>
                                        <div class="col-md-12" style="margin-top:20px; display:none;" id="idPlantilla">
                                            <i class="fa fa-file-pdf-o" style="margin-right:10px;"></i><a id="historialPrevPDF" style="cursor:pointer;">Generar PDF</a>
{#                                            <hr>#}
                                        </div>

                                        

                                        <div class="row" style="margin-top:10px;">
                                            <div class="col-md-12">
                                                <hr>
                                            </div>
                                        </div>

                                        <div class="row  pull-right" style="margin-top:10px;">
                                            <div class="col-md-12">
                                                <div class="form-grouphide col-sm-12">
                                                    {#<a class="btn btn-default btn-xs" id="cancelarNuevoConsulta">Cancelar</a>#}
                                                    <button type="submit" id="guardarPlantilla" name="dgplusbellebundle_antecedentes[submit]" class="btn btn-primary btn-xs btn btn">Guardar</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                
                                
                            </div>
                            <div id="camposPlantilla" class="camposPlantilla" style="margin-top: 30px">
                                <div class="row">
                                    <div class="col-md-12"></div>
                                    <div id="campos" class="col-md-12 campos"></div>
                                </div>
                            </div>                         
                            {#{% else %}
                                    <i class="fa fa-file-pdf-o"></i><a class="generarPDF" href="{{path(ruta,{id:consulta.id})}}"> Ver plantilla</a>
                            #}
                            {% endif %}
                                
                        
                        </p>
                </div><!-- /tab-content -->
                
                 <div class="tab-pane fade in" id="botabs8">
                        <p>
                            <strong></strong>
                            
                            {%if existeReceta == false %}
                                <div class="col-md-12" style="margin-top:20px;{# display:none;#}" id="idReceta">
                                    <i class="fa fa-file-pdf-o" style="margin-right:10px;"></i>
                                    <a id="recetaPrevPDF" style="cursor:pointer;">Generar PDF</a>
                                    <hr>
                                </div>
                                <div class="row" style="margin-top:10px;">
                                    
                                    <div class="col-md-12">
                                        <textarea class="col-md-12 form-control editorArea" id="receta" placeholder=""></textarea>
                                    </div>
                                    
                                    <div class="clearfix"></div>
                                    
                                    <div class="row" style="margin-top:10px;">
                                        <div class="col-md-12">
                                            <hr>
                                        </div>
                                    </div>

                                    <div class="row pull-right" style="margin-top:10px;">
                                        <div class="col-md-12">
                                            <div class="form-grouphide col-sm-12">
                                                {#<a class="btn btn-default btn-xs" id="cancelarNuevoConsulta">Cancelar</a>#}
                                                <button type="submit" id="guardarReceta" name="dgplusbellebundle_antecedentes[submit]" class="btn btn-primary btn-xs btn btn">Guardar</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            {% else %}
                                <i class="fa fa-file-pdf-o"></i><a class="generarPDF" href="{{path(rutaReceta,{id:consulta.id})}}"> Ver receta</a>
                            {% endif %}
                        </p>
                    
                    </div><!-- /tab-content -->
            </div><!-- /panel-body -->
        </div>
    {% else %}
        
    {% endif %}                
                    

</div>  

            
{% endblock %}


{% block javascripts_step %}
    

    <script src="{{ asset('Resources/alertifyjs/alertify.js') }}"></script>
    <script src="{{ asset('Resources/js/ConsultaPaciente.js') }}"></script>
    <script src="{{ asset('Resources/js/ConsultaEstetica.js') }}"></script>

    <script src="{{ asset('Resources/dropzone/dropzone.js') }}"></script>
     
     
     
    {#<script src="{{ asset('Resources/src/js/bootstrap.js')}}"></script>#}
     
    <script src="{{ asset('Resources/swal/sweetalert2.min.js') }}"></script>
    
    <script src="{{ asset('Resources/wrapkit/scripts/jquery.mask.js') }}"></script>
    <script src="{{ asset('Resources/Zebra/js/zebra_datepicker.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.2/js/select2.min.js"></script>
    {#<script src="{{ asset('Resources/wrapkit/scripts/dataTables.bootstrap.js') }}"></script>
    <script src="{{ asset('Resources/wrapkit/scripts/dataTables.tableTools.js') }}"></script>#}
    <script src="{{ asset('Resources/wrapkit/scripts/bootbox.js') }}"></script>
    <script src="https://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.11/js/dataTables.material.min.js "></script>
    
    
     
    <script>


        
        $("div#myId").dropzone({
            url: "/file/post",
            error: function(file) {
                swal('','Error al cargar imágenes, verifique si se ha guardado una consulta!','error');
              
            },
        });

        $(function () {
            $('.calZebra').Zebra_DatePicker({
                months:['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                days: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
                format: 'd-m-Y',
                show_clear_date:false,
                show_select_today: "Hoy",
            });
        });
        
        $(function () { 
            $( "#dgplusbellebundle_consulta_reportePlantilla_0" ).on( "click", function() {
                // Se muestra el combobox donde se selecciona la plantilla
                $("#lista_plantilla").show();
                
                // Se muestra el link para generar el pdf
                var capa = document.getElementById('previaEstPdf');
                capa.style.display = 'block';
            });
            
            
            $( "#dgplusbellebundle_consulta_registraReceta_0" ).on( "click", function() {
                // Se muestra el combobox donde se selecciona la plantilla
                $("#lista_receta").show();
            });
        });
    </script> 
    <script>
        $(function () { 
            $( "#dgplusbellebundle_consulta_reportePlantilla_1" ).on( "click", function() {
                // Se obtiene todos elementos que contengan la clase parametro
                var elements = document.getElementsByClassName('parametro');
                
                // Se oculta el link para generar el pdf
                var capa = document.getElementById('previaEstPdf');
                capa.style.display = 'none';
                
                // Se borran todos los elementohtmls que se encuentran en el div con id = campos
                $('#campos div').html('');
                
                // Se oculta el combobox donde se selecciona la plantilla
                $("#lista_plantilla").hide();
                
                // Se borran todos los elementos que contengan la clase = parametro
                while(elements.length > 0){
                    elements[0].parentNode.removeChild(elements[0]);
                }
                
                $('#dgplusbellebundle_consulta_campos option').each(function(index, option) {
                    $(option).remove();
                });
            });
            
            
            $( "#dgplusbellebundle_consulta_registraReceta_1" ).on( "click", function() {
                // Se obtiene todos elementos que contengan la clase parametro
                var elements = document.getElementsByClassName('parametro2');
                
                // Se borran todos los elementohtmls que se encuentran en el div con id = cReceta
                $('#cReceta div').html('');
                
                // Se oculta el combobox donde se selecciona la plantilla
                $("#lista_receta").hide();
                
                // Se borran todos los elementos que contengan la clase = parametro
                while(elements.length > 0){
                    elements[0].parentNode.removeChild(elements[0]);
                }
                
                $('#dgplusbellebundle_receta_campos option').each(function(index, option) {
                    $(option).remove();
                });
            });
        });
    </script>
    <script>
        var count = 0;
        {% if tipoPlantilla == 2 %}
            count = {{ tienePlantilla|length }}
        {% else %}            
            count = 0;
        {% endif %}
        $(function () { 
            $( "#dgplusbellebundle_consulta_plantilla" ).on( "change", function() {
                // Se obtiene el id de la plantilla
                var id = $( this ).val();
                //alert('prueba');
                $('#idPlantilla').show();
                // Se obtiene todos elementos que contengan la clase parametro
                var elements = document.getElementsByClassName('parametro');
                
                // Se borran todos los elementos que se encuentran en el div con id = campos
                $('#campos div').html('');
                
                // Se borran todos los elementos que contengan la clase = parametro
                while(elements.length > 0){
                    elements[0].parentNode.removeChild(elements[0]);
                }
                
                $('#dgplusbellebundle_consulta_campos option').each(function(index, option) {
                    $(option).remove();
                });
                
                // Se obtienen los campos necesarios para la plantilla seleccionada
                $.post( "{{path('admin_busqueda_parametros')}}", { id: id }, function( data ) {
                    var par = new Array();
                    par = data.query;
                    
                    // Si la plantilla contiene campos
                    if(par.length !== 0){
                        mostrarCampos(data.query);
                    }
                    else{
                        console.log( 'Esta plantilla no tiene campos que mostrar' );
                    }
                }, "json");
                
            });
            
            
            
            
        });
        
        function setCamposPlantilla(id){
            var lista = document.getElementById("dgplusbellebundle_consulta_campos");
            var campoPlantilla = $("#" + id).val();
            var campoNombre = $("#" + id).attr('name');
            var texto = id + '-' + campoNombre + '-' + campoPlantilla;
            
            lista.options.add(new Option(texto));
           
        }//  Fin de setCamposPlantilla
        
        function getCamposPlantilla(){
    
            var lista=document.getElementById("dgplusbellebundle_consulta_campos");
            var camposInfo = new Array();

            if(lista.length>0)
            {
                for(var i=0; i<lista.length; i++)  {
                camposInfo[i] = lista.options[i].text;
                }   

                for ( var i = 0, l = lista.options.length, o; i < l; i++ )
                {
                    o = lista.options[i];
                    if ( camposInfo.indexOf( o.text ) != -1 )
                    {
                        o.selected = true;                
                    }
                } 
                return false; 
            } 
            else {
                  return false;  
            }
        }//Fin de getCamposPlantilla
        
        // Funcion que muestra los campos de texto de la plantilla seleccionada
        function mostrarCampos(data) {
            var div = document.getElementById('campos');
            var form = $("form");
            //console.log(data[0]);
            //var form = document.createElement('form');
            //form.setAttribute('action', '{# {{path('admin_set_campos')}} #}');
            //form.setAttribute('method', 'POST');
            /*-----------*/
            
            var input = new Array();
            var label = new Array();
            var label2 = new Array();
            var campos = new Array();
            var saltos = new Array();
            var etiqueta = new Array();
            var clear = new Array();
            var i = 0;
            
            // Se recorre el array para mostrar los campos
            $.each( data, function( key, value ) {
                //window.print("<div class='col-md-1'>");
                var t = document.createTextNode(value.nombre);
                //window.print("</div");
                
                
                // Se crea un div donde se muestran los parametros
                campos[key] = document.createElement('div');
                campos[key].setAttribute('class', 'parametro col-md-12');
                
                // Se crea el campo de texto del parametro de la plantilla
                if(value.tipoParametro=='Textarea' || value.tipoParametro==''){
                    input[key] = document.createElement('textarea');
                    input[key].setAttribute('type', 'text');
                    input[key].setAttribute('placeholder', value.nombre);
                    input[key].setAttribute('class', 'form-control classPlantilla');
                    input[key].setAttribute('style', 'margin-bottom: 5px;resize:vertical;height:150px;');
                    input[key].setAttribute('name', value.nombre);
                    input[key].setAttribute('id', value.id);
                    
                    etiqueta[key] = document.createElement('p');
                    etiqueta[key].setAttribute('style', 'color: #646473; font-size: 13px; font-weight: 700;');
                    etiqueta[key].appendChild(t);

                    label[key] = document.createElement('label');

                    // Se introducen los elementos en el div con id = campos
                    label[key].appendChild(etiqueta[key]);
                    campos[key].appendChild(label[key]);
                    console.log(input[key]);
                    campos[key].appendChild(input[key]);
                    div.appendChild(campos[key]);
                }
                if(value.tipoParametro=='Radiobutton'){
                    $.post( "{{path('admin_busqueda_opciones_parametros')}}", { id: value.id }, function( opc ) {
                        var par = new Array();
                        par = opc.query;
                        //console.log(par[0]);
                        // Si la plantilla contiene campos
                        $.each( par, function( key2, value2 ) {
                            input[key] = document.createElement('input');
                            input[key].setAttribute('type', 'radio');
                            input[key].setAttribute('class', 'form-control classPlantilla');
                            input[key].setAttribute('name', value.nombre);
                            input[key].setAttribute('id', value.id);

                            etiqueta[key] = document.createElement('p');
                            etiqueta[key].appendChild(t);

                            label[key] = document.createElement('label');

                            // Se introducen los elementos en el div con id = campos
                            label[key].appendChild(etiqueta[key]);
                            campos[key].appendChild(label[key]);
                            
                            campos[key].appendChild(input[key]);
                            $('#'+value.id).append(value2.nombre);
                            div.appendChild(campos[key]);
                        });

                    }, "json");
                    
                    
                }
                if(value.tipoParametro=='Checkbox'){
                    campos[key].setAttribute('class', 'parametro col-md-6');
                    
                    var formgroup = document.createElement('div');
                    formgroup.setAttribute('class', 'form-group');

                    label[key] = document.createElement('label');
                    etiqueta[key] = document.createElement('p');

                    etiqueta[key].setAttribute('style', 'color: #646473; font-size: 13px;');
                    etiqueta[key].appendChild(t);

                    label[key].appendChild(etiqueta[key]);

                    var divLabel = document.createElement('div');
                    formgroup.setAttribute('style', 'margin-bottom: 10px;');

                    divLabel.appendChild(label[key]);
                    formgroup.appendChild(divLabel);
                    
                    $.post( "{{path('admin_busqueda_opciones_parametros')}}", { id: value.id }, function( opc2 ) {
                        var par2 = new Array();
                        par2 = opc2.query;
                        
                        // Si la plantilla contiene campos
                        $.each( par2, function( key3, value3 ) {
                            var chk = document.createElement('div');
                            
                            input[key3] = document.createElement('input');
                            input[key3].setAttribute('type', 'checkbox');
                            input[key3].setAttribute('class', 'form-control');
                            input[key3].setAttribute('name', value.nombre);
                            input[key3].setAttribute('id', value.id);
                            
                            var chk = document.createElement('div');
                            chk.setAttribute('class', 'checkbox');
                            //chk.setAttribute('style', 'margin-top: 10px');
                            //formgroup.appendChild(divLabel);
                            
                            label2[key3] = document.createElement('label');
                            label2[key3].htmlFor = "id";
                            //label2[key3].appendChild(document.createTextNode(value3.nombre));
                           
                            {#var chk = document.createElement('div');
                            chk.setAttribute('class', 'nice-checkbox checkbox-inline');#}
                            
                            chk.appendChild(input[key3]);
                            chk.appendChild(document.createTextNode(value3.nombre));
                            
                            formgroup.appendChild(chk);
                        
                        });
                        console.log(key);
                        campos[key].appendChild(formgroup);
                        div.appendChild(campos[key]);
                        
                        
                        
                        
                        
                    }, "json");
                    if( ((i + 1) % 2) == 0 ) {
                            console.log(((i + 1) % 2)+' '+i);
                            clear[key] = document.createElement('div');
                            clear[key].setAttribute('class', 'clearfix');
                            div.appendChild(clear[key]);
                        }
                }
                
                
                
             //   input[key].setAttribute('onblur', 'setCamposPlantilla(' + value.id + ')');
                
                // Se crea el label del parametro de la plantilla
                
                
                if(((key+1)%3)==0){
                    //console.log(key%3);
                    //console.log(key+' '+(key+1) + '-'+(key+1)%3);
                    saltos[key] = document.createElement('hr');
                    saltos[key] = document.createElement('div');
                    saltos[key].setAttribute('class', 'clearfix');
                    div.appendChild(saltos[key]);
                }
                i++;
            });
            validarConsulta();
        } // Fin de mostrarCampos
        
        // Funcion que muestra los campos de texto de la plantilla seleccionada
        function mostrarCamposCorporal(data) {
            var div = document.getElementById('campos');
            var form = $("form");
            
            var input = new Array();
            var label = new Array();
            var label2 = new Array();
            var campos = new Array();
            var saltos = new Array();
            var etiqueta = new Array();
            var clear = new Array();
            var i = 0;
            
            var comparativo = document.createElement('div');
            comparativo.setAttribute('id', 'comparativoCorp');
            comparativo.setAttribute('class', 'text-right');
            
            var comparativoUrl = document.createElement('a');
            comparativoUrl.setAttribute('id', 'urlComparativoCrp');
            comparativoUrl.setAttribute('style', 'color: blue;');
    
            var comparativoText = document.createTextNode('Ver comparativo');
            var comparativoHr = document.createElement('hr');
            
            comparativoUrl.appendChild(comparativoText);
            
            comparativo.appendChild(comparativoUrl);
            comparativo.appendChild(comparativoHr);
            
            div.appendChild(comparativo);
            
            // Se recorre el array para mostrar los campos
            $.each( data, function( key, value ) {
                var t = document.createTextNode(value.nombre);
                
                // Se crea un div donde se muestran los parametros
                campos[key] = document.createElement('div');
                //campos[key].setAttribute('class', 'parametro col-md-11');
                
                campos[key].setAttribute('class', 'parametro col-md-6');
                campos[key].setAttribute('style', 'margin-top: 15px;');

                var formgroup = document.createElement('div');
                formgroup.setAttribute('class', 'form-group');
                formgroup.setAttribute('style', 'margin-bottom: 10px;');

                label[key] = document.createElement('label');
                
                etiqueta[key] = document.createElement('p');
                etiqueta[key].setAttribute('style', 'color: #646473; font-size: 13px;');
                etiqueta[key].appendChild(t);
                label[key].appendChild(etiqueta[key]);

                var divLabel = document.createElement('div');

                divLabel.appendChild(label[key]);
                formgroup.appendChild(divLabel);
                    
                $.post( "{{path('admin_busqueda_opciones_estetica')}}", { id: value.id }, function( opc2 ) {
                    var par2 = new Array();
                    par2 = opc2.query;

                    // Si la plantilla contiene campos
                    $.each( par2, function( key3, value3 ) {
                        var row = document.createElement('div');
                        var ax = document.createElement('div');
                        var chk = document.createElement('div');
                        var lbl = document.createElement('div');
                        lbl.setAttribute('class', 'lbl col-md-8');
                        lbl.setAttribute('class', 'row');
                        
                        input[key3] = document.createElement('input');
                        input[key3].setAttribute('type', 'checkbox');
                        input[key3].setAttribute('class', 'form-control classCorporal');
                        input[key3].setAttribute('name', value3.nombre);
                        input[key3].setAttribute('id', value3.opcion);
                        input[key3].setAttribute('value', value3.opcion);

                        var chk = document.createElement('div');
                        chk.setAttribute('class', 'checkbox col-md-2');
                        chk.setAttribute('style', 'margin-top: -10px;');
                        label2[key3] = document.createElement('label');
                        label2[key3].htmlFor = "id";

                        chk.appendChild(input[key3]);
                        lbl.appendChild(document.createTextNode(value3.nombre));
                        
                        ax.appendChild(chk);
                        ax.appendChild(lbl);
                        row.appendChild(ax);
                        formgroup.appendChild(row);
                    });

                    console.log(key);
                    campos[key].appendChild(formgroup);
                    div.appendChild(campos[key]);


                }, "json");
                
                if( ((i + 1) % 2) == 0 ) {
                        //console.log(((i + 1) % 2)+' '+i);
                        clear[key] = document.createElement('div');
                        clear[key].setAttribute('class', 'clearfix');
                        div.appendChild(clear[key]);
                }
               
                if(((key+1)%3)==0){
                    //console.log(key%3);
                    //console.log(key+' '+(key+1) + '-'+(key+1)%3);
                    saltos[key] = document.createElement('hr');
                    saltos[key] = document.createElement('div');
                    saltos[key].setAttribute('class', 'clearfix');
                    div.appendChild(saltos[key]);
                }
                i++;
            });
            
            var clearfix = document.createElement('div');
            clearfix.setAttribute('class', 'clearfix');
            div.appendChild(clearfix);
            
            var corporal = document.createElement('div');
            corporal.setAttribute('class', 'col-md-12 corporal');
            corporal.setAttribute('style', 'margin-bottom: 15px;');
            
            var rowCorp = document.createElement('div');
            rowCorp.setAttribute('class', 'row');
            
            // Elemento para registrar peso 
            var formgroupCrpPeso = document.createElement('div');
            formgroupCrpPeso.setAttribute('class', 'form-group col-md-4');
            formgroupCrpPeso.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelPeso = document.createElement('label');
            var etiquetaPeso = document.createElement('p');
            etiquetaPeso.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaPeso.appendChild(document.createTextNode('Peso'));
            labelPeso.appendChild(etiquetaPeso);
            var divLabelPeso = document.createElement('div');
            divLabelPeso.appendChild(labelPeso);
            formgroupCrpPeso.appendChild(divLabelPeso);
            
            var inputPeso = document.createElement('input');
            inputPeso.setAttribute('type', 'text');
            inputPeso.setAttribute('class', 'form-control corporall');
            inputPeso.setAttribute('name', 'corporal[peso]');
            inputPeso.setAttribute('id', 'peso');
            //inputPeso.setAttribute('value', value3.opcion);
            formgroupCrpPeso.appendChild(inputPeso);
            rowCorp.appendChild(formgroupCrpPeso);
            //corporal.appendChild(rowCorp);  
            //div.appendChild(corporal);
            
            // Elemento para registrar Grasa corporal
            var formgroupCrpGrasaCorp = document.createElement('div');
            formgroupCrpGrasaCorp.setAttribute('class', 'form-group col-md-4');
            formgroupCrpGrasaCorp.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelGrasaCorp = document.createElement('label');
            var etiquetaGrasaCorp = document.createElement('p');
            etiquetaGrasaCorp.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaGrasaCorp.appendChild(document.createTextNode('Grasa corporal'));
            labelGrasaCorp.appendChild(etiquetaGrasaCorp);
            var divLabelGrasaCorp = document.createElement('div');
            divLabelGrasaCorp.appendChild(labelGrasaCorp);
            formgroupCrpGrasaCorp.appendChild(divLabelGrasaCorp);
            
            var inputGrasaCorp = document.createElement('input');
            inputGrasaCorp.setAttribute('type', 'text');
            inputGrasaCorp.setAttribute('class', 'form-control corporall');
            inputGrasaCorp.setAttribute('name', 'corporal[grasa_corporal]');
            inputGrasaCorp.setAttribute('id', 'grasa_corporal');
            
            formgroupCrpGrasaCorp.appendChild(inputGrasaCorp);
            rowCorp.appendChild(formgroupCrpGrasaCorp);
            //corporal.appendChild(rowCorp);  
            //div.appendChild(corporal);
            
            // Elemento para registrar Agua Corporal
            var formgroupCrpAguaCorp = document.createElement('div');
            formgroupCrpAguaCorp.setAttribute('class', 'form-group col-md-4');
            formgroupCrpAguaCorp.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelAguaCorp = document.createElement('label');
            var etiquetaAguaCorp = document.createElement('p');
            etiquetaAguaCorp.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaAguaCorp.appendChild(document.createTextNode('Agua corporal'));
            labelAguaCorp.appendChild(etiquetaAguaCorp);
            var divLabelAguaCorp = document.createElement('div');
            divLabelAguaCorp.appendChild(labelAguaCorp);
            formgroupCrpAguaCorp.appendChild(divLabelAguaCorp);
            
            var inputAguaCorp = document.createElement('input');
            inputAguaCorp.setAttribute('type', 'text');
            inputAguaCorp.setAttribute('class', 'form-control corporall');
            inputAguaCorp.setAttribute('name', 'corporal[agua_corporal]');
            inputAguaCorp.setAttribute('id', 'agua_corporal');
            
            formgroupCrpAguaCorp.appendChild(inputAguaCorp);
            rowCorp.appendChild(formgroupCrpAguaCorp);
            
            // Elemento para registrar Masa musculo
            var formgroupCrpMMusculo = document.createElement('div');
            formgroupCrpMMusculo.setAttribute('class', 'form-group col-md-4');
            formgroupCrpMMusculo.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelMMusculo = document.createElement('label');
            var etiquetaMMusculo = document.createElement('p');
            etiquetaMMusculo.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaMMusculo.appendChild(document.createTextNode('Masa musculo'));
            labelMMusculo.appendChild(etiquetaMMusculo);
            var divLabelMMusculo = document.createElement('div');
            divLabelMMusculo.appendChild(labelMMusculo);
            formgroupCrpMMusculo.appendChild(divLabelMMusculo);
            
            var inputMMusculo = document.createElement('input');
            inputMMusculo.setAttribute('type', 'text');
            inputMMusculo.setAttribute('class', 'form-control corporall');
            inputMMusculo.setAttribute('name', 'corporal[masa_musculo]');
            inputMMusculo.setAttribute('id', 'masa_musculo');
            
            formgroupCrpMMusculo.appendChild(inputMMusculo);
            rowCorp.appendChild(formgroupCrpMMusculo);
            
            // Elemento para registrar Valoracion fisica
            var formgroupCrpValFisica = document.createElement('div');
            formgroupCrpValFisica.setAttribute('class', 'form-group col-md-4');
            formgroupCrpValFisica.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelValFisica = document.createElement('label');
            var etiquetaValFisica = document.createElement('p');
            etiquetaValFisica.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaValFisica.appendChild(document.createTextNode('Valoracion Fisica'));
            labelValFisica.appendChild(etiquetaValFisica);
            var divLabelValFisica = document.createElement('div');
            divLabelValFisica.appendChild(labelValFisica);
            formgroupCrpValFisica.appendChild(divLabelValFisica);
            
            var inputValFisica = document.createElement('input');
            inputValFisica.setAttribute('type', 'text');
            inputValFisica.setAttribute('class', 'form-control corporall');
            inputValFisica.setAttribute('name', 'corporal[valoracion_fisica]');
            inputValFisica.setAttribute('id', 'valoracion_fisica');
            
            formgroupCrpValFisica.appendChild(inputValFisica);
            rowCorp.appendChild(formgroupCrpValFisica);
            
            // Elemento para registrar DCI / BMR
            var formgroupCrpDCIBMR = document.createElement('div');
            formgroupCrpDCIBMR.setAttribute('class', 'form-group col-md-4');
            formgroupCrpDCIBMR.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelDCIBMR = document.createElement('label');
            var etiquetaDCIBMR = document.createElement('p');
            etiquetaDCIBMR.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaDCIBMR.appendChild(document.createTextNode('DCI / BMR'));
            labelDCIBMR.appendChild(etiquetaDCIBMR);
            var divLabelDCIBMR = document.createElement('div');
            divLabelDCIBMR.appendChild(labelDCIBMR);
            formgroupCrpDCIBMR.appendChild(divLabelDCIBMR);
            
            var inputDCIBMR = document.createElement('input');
            inputDCIBMR.setAttribute('type', 'text');
            inputDCIBMR.setAttribute('class', 'form-control corporall');
            inputDCIBMR.setAttribute('name', 'corporal[dci_bmr]');
            inputDCIBMR.setAttribute('id', 'dci_bmr');
            
            formgroupCrpDCIBMR.appendChild(inputDCIBMR);
            rowCorp.appendChild(formgroupCrpDCIBMR);
            
            // Elemento para registrar Edad metabolica
            var formgroupCrpEdadMet = document.createElement('div');
            formgroupCrpEdadMet.setAttribute('class', 'form-group col-md-4');
            formgroupCrpEdadMet.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelEdadMet = document.createElement('label');
            var etiquetaEdadMet = document.createElement('p');
            etiquetaEdadMet.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaEdadMet.appendChild(document.createTextNode('Edad metabolica'));
            labelEdadMet.appendChild(etiquetaEdadMet);
            var divLabelEdadMet = document.createElement('div');
            divLabelEdadMet.appendChild(labelEdadMet);
            formgroupCrpEdadMet.appendChild(divLabelEdadMet);
            
            var inputEdadMet = document.createElement('input');
            inputEdadMet.setAttribute('type', 'text');
            inputEdadMet.setAttribute('class', 'form-control corporall');
            inputEdadMet.setAttribute('name', 'corporal[edad_metabolica]');
            inputEdadMet.setAttribute('id', 'edad_metabolica');
            
            formgroupCrpEdadMet.appendChild(inputEdadMet);
            rowCorp.appendChild(formgroupCrpEdadMet);
            
            // Elemento para registrar Masa osea
            var formgroupCrpMasaOsea = document.createElement('div');
            formgroupCrpMasaOsea.setAttribute('class', 'form-group col-md-4');
            formgroupCrpMasaOsea.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelMasaOsea = document.createElement('label');
            var etiquetaMasaOsea = document.createElement('p');
            etiquetaMasaOsea.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaMasaOsea.appendChild(document.createTextNode('Masa Osea'));
            labelMasaOsea.appendChild(etiquetaMasaOsea);
            var divLabelMasaOsea = document.createElement('div');
            divLabelMasaOsea.appendChild(labelMasaOsea);
            formgroupCrpMasaOsea.appendChild(divLabelMasaOsea);
            
            var inputMasaOsea = document.createElement('input');
            inputMasaOsea.setAttribute('type', 'text');
            inputMasaOsea.setAttribute('class', 'form-control corporall');
            inputMasaOsea.setAttribute('name', 'corporal[masa_osea]');
            inputMasaOsea.setAttribute('id', 'masa_osea');
            
            formgroupCrpMasaOsea.appendChild(inputMasaOsea);
            rowCorp.appendChild(formgroupCrpMasaOsea);
            
            // Elemento para registrar Grasa visceral
            var formgroupCrpGrVisceral = document.createElement('div');
            formgroupCrpGrVisceral.setAttribute('class', 'form-group col-md-4');
            formgroupCrpGrVisceral.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelGrVisceral = document.createElement('label');
            var etiquetaGrVisceral = document.createElement('p');
            etiquetaGrVisceral.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaGrVisceral.appendChild(document.createTextNode('Grasa visceral'));
            labelGrVisceral.appendChild(etiquetaGrVisceral);
            var divLabelGrVisceral = document.createElement('div');
            divLabelGrVisceral.appendChild(labelGrVisceral);
            formgroupCrpGrVisceral.appendChild(divLabelGrVisceral);
            
            var inputGrVisceral = document.createElement('input');
            inputGrVisceral.setAttribute('type', 'text');
            inputGrVisceral.setAttribute('class', 'form-control corporall');
            inputGrVisceral.setAttribute('name', 'corporal[grasa_visceral]');
            inputGrVisceral.setAttribute('id', 'grasa_visceral');
            
            formgroupCrpGrVisceral.appendChild(inputGrVisceral);
            rowCorp.appendChild(formgroupCrpGrVisceral);
            
            corporal.appendChild(rowCorp);  
            div.appendChild(corporal);
            
            var clearfix = document.createElement('div');
            clearfix.setAttribute('class', 'clearfix');
            div.appendChild(clearfix);
            
            validarConsultaEstetica();
            validarConsulta();
        } // Fin de mostrarCampos
        
        // Funcion que muestra los campos de texto de la plantilla seleccionada
        function mostrarCamposFacial(data) {
            var div = document.getElementById('campos');
            var form = $("form");
            
            var input = new Array();
            var label = new Array();
            var label2 = new Array();
            var campos = new Array();
            var saltos = new Array();
            var etiqueta = new Array();
            var clear = new Array();
            var i = 0;
            
            // Se recorre el array para mostrar los campos
            $.each( data, function( key, value ) {
                var t = document.createTextNode(value.nombre);
                
                // Se crea un div donde se muestran los parametros
                campos[key] = document.createElement('div');
                //campos[key].setAttribute('class', 'parametro col-md-11');
                
                campos[key].setAttribute('class', 'parametro col-md-4');

                var formgroup = document.createElement('div');
                formgroup.setAttribute('class', 'form-group');
                formgroup.setAttribute('style', 'margin-bottom: 10px;');

                label[key] = document.createElement('label');
                
                etiqueta[key] = document.createElement('p');
                etiqueta[key].setAttribute('style', 'color: #646473; font-size: 13px;');
                etiqueta[key].appendChild(t);
                label[key].appendChild(etiqueta[key]);

                var divLabel = document.createElement('div');

                divLabel.appendChild(label[key]);
                formgroup.appendChild(divLabel);
                    
                $.post( "{{path('admin_busqueda_opciones_estetica')}}", { id: value.id }, function( opc2 ) {
                    var par2 = new Array();
                    par2 = opc2.query;

                    // Si la plantilla contiene campos
                    $.each( par2, function( key3, value3 ) {
                        var row = document.createElement('div');
                        var ax = document.createElement('div');
                        var chk = document.createElement('div');
                        var lbl = document.createElement('div');
                        lbl.setAttribute('class', 'lbl col-md-8');
                        lbl.setAttribute('class', 'row');
                        input[key3] = document.createElement('input');
                        input[key3].setAttribute('type', 'checkbox');
                        input[key3].setAttribute('class', 'form-control classCorporal');
                        input[key3].setAttribute('name', value3.nombre);
                        input[key3].setAttribute('id', value3.opcion);
                        input[key3].setAttribute('value', value3.opcion);

                        var chk = document.createElement('div');
                        chk.setAttribute('class', 'checkbox col-md-2');
                        chk.setAttribute('style', 'margin-top: -10px;');
                        label2[key3] = document.createElement('label');
                        label2[key3].htmlFor = "id";

                        chk.appendChild(input[key3]);
                        lbl.appendChild(document.createTextNode(value3.nombre));
                        
                        ax.appendChild(chk);
                        ax.appendChild(lbl);
                        row.appendChild(ax);
                        formgroup.appendChild(row);

                    });
                    console.log(key);
                    campos[key].appendChild(formgroup);
                    div.appendChild(campos[key]);

                    {#if( ((i + 1) % 2) === 0 ) {
                        //console.log(((i + 1) % 2)+' '+i);
                        clear[key] = document.createElement('div');
                        clear[key].setAttribute('class', 'clearfix');
                        div.appendChild(clear[key]);
                    } #}  
                    

                    i++;
                    console.log(i);
                }, "json");
                
                if( ((i + 1) % 2) === 0 ) {
                        //console.log(((i + 1) % 2)+' '+i);
                        clear[key] = document.createElement('div');
                        clear[key].setAttribute('class', 'clearfix');
                        div.appendChild(clear[key]);
                }
               
                {#if(((key+1)%3)==0){
                    //console.log(key%3);
                    //console.log(key+' '+(key+1) + '-'+(key+1)%3);
                    saltos[key] = document.createElement('hr');
                    saltos[key] = document.createElement('div');
                    saltos[key].setAttribute('class', 'clearfix');
                    div.appendChild(saltos[key]);
                }#}
                
            });
            validarConsulta();
            validarConsultaEstetica();
        } // Fin de mostrarCampos
        
        // Funcion que muestra los campos de texto de la consulta de estetica de Botox
        function mostrarCamposBotox() {
            var div = document.getElementById('campos');
            
            var comparativo = document.createElement('div');
            comparativo.setAttribute('id', 'comparativoBotox');
            comparativo.setAttribute('class', 'text-right comparativoBotox-' + count);
            
            
            
            if(count == 0){
                var comparativoUrl = document.createElement('a');
                comparativoUrl.setAttribute('id', 'urlComparativoBotox');
                
                var nuevoUrl = document.createElement('a');
                nuevoUrl.setAttribute('id', 'nuevoUrlBotox');
                nuevoUrl.setAttribute('style', 'color: blue;');
                
                var nuevoText = document.createTextNode('Nuevo registro de detalle de consulta');
                nuevoUrl.appendChild(nuevoText);

                comparativo.appendChild(nuevoUrl);

                {#var separador = document.createTextNode(' | ');
                comparativo.appendChild(separador);#}
                
                var comparativoText = document.createTextNode('Ver comparativo');
                comparativoUrl.appendChild(comparativoText);
                //comparativo.appendChild(comparativoUrl);
            } else {
                var borrarUrl = document.createElement('a');
                borrarUrl.setAttribute('id', 'borrarUrlBotox-' + count);
                borrarUrl.setAttribute('class', 'borrarRegistro');
                borrarUrl.setAttribute('style', 'color: red;');
                
                var borrarText = document.createTextNode('Eliminar registro');
                borrarUrl.appendChild(borrarText);
                
                comparativo.appendChild(borrarUrl);
            }
            
            var comparativoHr = document.createElement('hr');
            
            comparativo.appendChild(comparativoHr);
            div.appendChild(comparativo);
            
            var clearfix = document.createElement('div');
            clearfix.setAttribute('class', 'clearfix');
            div.appendChild(clearfix);
            
            var botox = document.createElement('div');
            botox.setAttribute('class', 'col-md-12 botox-' + count);
            botox.setAttribute('style', 'margin-bottom: 15px;');
            
            var rowCorp = document.createElement('div');
            rowCorp.setAttribute('class', 'row');
            
            // Elemento para registrar Area a inyectar 
            var formgroupAreaInyectar = document.createElement('div');
            formgroupAreaInyectar.setAttribute('class', 'form-group col-md-4');
            formgroupAreaInyectar.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelAreaInyectar = document.createElement('label');
            var etiquetaInyectar = document.createElement('p');
            etiquetaInyectar.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaInyectar.appendChild(document.createTextNode('Area a inyectar'));
            labelAreaInyectar.appendChild(etiquetaInyectar);
            var divLabelAreaInyectar = document.createElement('div');
            divLabelAreaInyectar.appendChild(labelAreaInyectar);
            formgroupAreaInyectar.appendChild(divLabelAreaInyectar);
            
            var inputAreaInyectar = document.createElement('input');
            inputAreaInyectar.setAttribute('type', 'text');
            inputAreaInyectar.setAttribute('class', 'form-control cbotox');
            inputAreaInyectar.setAttribute('name', 'botox['+ count +'][area_inyectar]');
            inputAreaInyectar.setAttribute('id', 'area_inyectar');
            //inputPeso.setAttribute('value', value3.opcion);
            formgroupAreaInyectar.appendChild(inputAreaInyectar);
            rowCorp.appendChild(formgroupAreaInyectar);
            //corporal.appendChild(rowCorp);  
            //div.appendChild(corporal);
            
            // Elemento para registrar Unidades
            var formgroupUnidades = document.createElement('div');
            formgroupUnidades.setAttribute('class', 'form-group col-md-4');
            formgroupUnidades.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelUnidades = document.createElement('label');
            var etiquetaUnidades = document.createElement('p');
            etiquetaUnidades.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaUnidades.appendChild(document.createTextNode('Unidades'));
            labelUnidades.appendChild(etiquetaUnidades);
            var divLabelUnidades = document.createElement('div');
            divLabelUnidades.appendChild(labelUnidades);
            formgroupUnidades.appendChild(divLabelUnidades);
            
            var inputUnidades = document.createElement('input');
            inputUnidades.setAttribute('type', 'text');
            inputUnidades.setAttribute('class', 'form-control cbotox');
            inputUnidades.setAttribute('name', 'botox['+ count +'][unidades]');
            inputUnidades.setAttribute('id', 'unidades');
            
            formgroupUnidades.appendChild(inputUnidades);
            rowCorp.appendChild(formgroupUnidades);
            //corporal.appendChild(rowCorp);  
            //div.appendChild(corporal);
            
            // Elemento para registrar Fecha de Caducidad
            var formgroupFechaCaducidad = document.createElement('div');
            formgroupFechaCaducidad.setAttribute('class', 'form-group col-md-4');
            formgroupFechaCaducidad.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelFechaCaducidad = document.createElement('label');
            var etiquetaFechaCaducidad = document.createElement('p');
            etiquetaFechaCaducidad.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaFechaCaducidad.appendChild(document.createTextNode('Fecha de caducidad'));
            labelFechaCaducidad.appendChild(etiquetaFechaCaducidad);
            var divLabelFechaCaducidad = document.createElement('div');
            divLabelFechaCaducidad.appendChild(labelFechaCaducidad);
            formgroupFechaCaducidad.appendChild(divLabelFechaCaducidad);
            
            var inputFechaCaducidad = document.createElement('input');
            inputFechaCaducidad.setAttribute('type', 'text');
            inputFechaCaducidad.setAttribute('class', 'form-control cbotox calZebra ');
            inputFechaCaducidad.setAttribute('name', 'botox['+ count +'][caducidad]');
            inputFechaCaducidad.setAttribute('id', 'caducidad-' + count);
            
            formgroupFechaCaducidad.appendChild(inputFechaCaducidad);
            rowCorp.appendChild(formgroupFechaCaducidad);
            
            // Elemento para registrar Número de Lote
            var formgroupLote = document.createElement('div');
            formgroupLote.setAttribute('class', 'form-group col-md-4');
            formgroupLote.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelLote = document.createElement('label');
            var etiquetaLote = document.createElement('p');
            etiquetaLote.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaLote.appendChild(document.createTextNode('Lote No.'));
            labelLote.appendChild(etiquetaLote);
            var divLabelLote = document.createElement('div');
            divLabelLote.appendChild(labelLote);
            formgroupLote.appendChild(divLabelLote);
            
            var inputLote = document.createElement('input');
            inputLote.setAttribute('type', 'text');
            inputLote.setAttribute('class', 'form-control cbotox');
            inputLote.setAttribute('name', 'botox['+ count +'][lote]');
            inputLote.setAttribute('id', 'lote');
            
            formgroupLote.appendChild(inputLote);
            rowCorp.appendChild(formgroupLote);
            
            // Elemento para registrar Marca del producto
            var formgroupMarcaProducto = document.createElement('div');
            formgroupMarcaProducto.setAttribute('class', 'form-group col-md-4');
            formgroupMarcaProducto.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelMarcaProducto = document.createElement('label');
            var etiquetaMarcaProducto = document.createElement('p');
            etiquetaMarcaProducto.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaMarcaProducto.appendChild(document.createTextNode('Marca del producto'));
            labelMarcaProducto.appendChild(etiquetaMarcaProducto);
            var divLabelMarcaProducto = document.createElement('div');
            divLabelMarcaProducto.appendChild(labelMarcaProducto);
            formgroupMarcaProducto.appendChild(divLabelMarcaProducto);
            
            var inputMarcaProducto = document.createElement('input');
            inputMarcaProducto.setAttribute('type', 'text');
            inputMarcaProducto.setAttribute('class', 'form-control cbotox');
            inputMarcaProducto.setAttribute('name', 'botox['+ count +'][marca_producto]');
            inputMarcaProducto.setAttribute('id', 'marca_producto');
            
            formgroupMarcaProducto.appendChild(inputMarcaProducto);
            rowCorp.appendChild(formgroupMarcaProducto);
            
            // Elemento para registrar Número de aplicación
            var formgroupNumAplicacion = document.createElement('div');
            formgroupNumAplicacion.setAttribute('class', 'form-group col-md-4');
            formgroupNumAplicacion.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelNumAplicacion = document.createElement('label');
            var etiquetaNumAplicacion = document.createElement('p');
            etiquetaNumAplicacion.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaNumAplicacion.appendChild(document.createTextNode('No. Aplicacion'));
            labelNumAplicacion.appendChild(etiquetaNumAplicacion);
            var divLabelNumAplicacion = document.createElement('div');
            divLabelNumAplicacion.appendChild(labelNumAplicacion);
            formgroupNumAplicacion.appendChild(divLabelNumAplicacion);
            
            var inputNumAplicacion = document.createElement('input');
            inputNumAplicacion.setAttribute('type', 'text');
            inputNumAplicacion.setAttribute('class', 'form-control cbotox');
            inputNumAplicacion.setAttribute('name', 'botox['+ count +'][num_aplicacion]');
            inputNumAplicacion.setAttribute('id', 'num_aplicacion');
            
            formgroupNumAplicacion.appendChild(inputNumAplicacion);
            rowCorp.appendChild(formgroupNumAplicacion);
            
            // Elemento para registrar Valor
            var formgroupValor = document.createElement('div');
            formgroupValor.setAttribute('class', 'form-group col-md-4');
            formgroupValor.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelValor = document.createElement('label');
            var etiquetaValor = document.createElement('p');
            etiquetaValor.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaValor.appendChild(document.createTextNode('Valor'));
            labelValor.appendChild(etiquetaValor);
            var divLabelValor = document.createElement('div');
            divLabelValor.appendChild(labelValor);
            formgroupValor.appendChild(divLabelValor);
            
            var inputValor = document.createElement('input');
            inputValor.setAttribute('type', 'text');
            inputValor.setAttribute('class', 'form-control cbotox');
            inputValor.setAttribute('name', 'botox['+ count +'][valor]');
            inputValor.setAttribute('id', 'botox_valor');
            
            formgroupValor.appendChild(inputValor);
            rowCorp.appendChild(formgroupValor);
            
            if(count == 0){
                // Elemento para registrar Recomendaciones
                var formgroupRecomendaciones = document.createElement('div');
                formgroupRecomendaciones.setAttribute('class', 'form-group col-md-8');
                formgroupRecomendaciones.setAttribute('style', 'margin-bottom: 10px;');

                var labelRecomendaciones = document.createElement('label');
                var etiquetaRecomendaciones = document.createElement('p');
                etiquetaRecomendaciones.setAttribute('style', 'color: #646473; font-size: 13px;');
                etiquetaRecomendaciones.appendChild(document.createTextNode('Recomendaciones'));
                labelRecomendaciones.appendChild(etiquetaRecomendaciones);
                var divLabelRecomendaciones = document.createElement('div');
                divLabelRecomendaciones.appendChild(labelRecomendaciones);
                formgroupRecomendaciones.appendChild(divLabelRecomendaciones);

                var inputRecomendaciones = document.createElement('textarea');
                inputRecomendaciones.setAttribute('type', 'text');
                inputRecomendaciones.setAttribute('class', 'form-control cbotox');
                inputRecomendaciones.setAttribute('name', 'botox['+ count +'][recomendaciones]');
                inputRecomendaciones.setAttribute('id', 'botox_recomendaciones');

                formgroupRecomendaciones.appendChild(inputRecomendaciones);
                rowCorp.appendChild(formgroupRecomendaciones);
            }
            
            botox.appendChild(rowCorp);  
            div.appendChild(botox);
            
            var clearfix = document.createElement('div');
            clearfix.setAttribute('class', 'clearfix');
            div.appendChild(clearfix);
            
            count++;
            
            //validarConsultaBotox();
            validarConsulta();
            
            $('.calZebra').Zebra_DatePicker({
                months:['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
                days: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
                format: 'd-m-Y',
                show_clear_date:false,
                show_select_today: "Hoy",
            });
            
            {#$('.caducidad').daterangepicker({
                singleDatePicker: true,
                showDropdowns: true,
                locale: {
                    format: 'YYYY-MM-DD'
                },
            });#}
            
            $('.caducidad').val('');
        } // Fin de mostrarCamposBotox 
        
        function mostrarCampos2(data) {
            var div = document.getElementById('cReceta');
            var form = $("form");
           
            //var form = document.createElement('form');
            //form.setAttribute('action', '{# {{path('admin_set_campos')}} #}');
            //form.setAttribute('method', 'POST');
            /*-----------*/
            
            var input = new Array();
            var label = new Array();
            var campos = new Array();
            var etiqueta = new Array();
            
            // Se recorre el array para mostrar los campos
            $.each( data, function( key, value ) {
                var t = document.createTextNode(value.nombre);
                
                // Se crea un div donde se muestran los parametros
                campos[key] = document.createElement('div');
                campos[key].setAttribute('class', 'parametro2 col-md-12');
                
                // Se crea el campo de texto del parametro de la plantilla
                input[key] = document.createElement('textarea');
                input[key].setAttribute('type', 'text');
                input[key].setAttribute('placeholder', value.nombre);
                input[key].setAttribute('class', 'form-control classReceta');
                input[key].setAttribute('style', 'margin-bottom: 5px;width:100%;resize:vertical;height:150px;');
                input[key].setAttribute('name', value.nombre+"2");
                input[key].setAttribute('id', value.id);
             //   input[key].setAttribute('onblur', 'setCamposPlantilla(' + value.id + ')');
                
                // Se crea el label del parametro de la plantilla
                etiqueta[key] = document.createElement('p');
                etiqueta[key].setAttribute('style', 'color: #646473; font-size: 13px; font-weight: 700;');
                etiqueta[key].appendChild(t);
                
                label[key] = document.createElement('label');
                
                // Se introducen los elementos en el div con id = campos
                label[key].appendChild(etiqueta[key]);
                campos[key].appendChild(label[key]);
                campos[key].appendChild(input[key]);
                div.appendChild(campos[key]);
            });
            validarConsulta();
        } // Fin de mostrarCampos
    </script> 
    <script>

    // Get the ul that holds the collection of tags
    var collectionHolder = $('div.placas');
    var collectionHolder2 = $('div.placas2');
    var col=$('#hnr_sircimbundle_estudioradiologicotype_placas');
    // setup an "add a tag" link
    var $addTagLink = $('<div class="row"><div class="col-md-12"><a href="#" class="add_placa_link btn btn-primary">Agregar producto</a></div></div>');
    var $addTagLink2 = $('<div class="row"><div class="col-md-12"><a href="#" class="add_placa_link2 btn btn-primary">Agregar foto</a></div></div>');
    var $removeTagLink = $('<a href="#" class="remove_placa_link btn btn-danger">Eliminar</a>');
    var $removeTagLink2 = $('<a href="#" class="remove_placa_link2 btn btn-danger">Eliminar</a>');
    
    {% if flag == 0 %}    
        var $newLinkLi = $('<div class="col-md-12 addItem"></div>').append($addTagLink);
        var $newLinkLi2 = $('<div class="col-md-12 addItem"></div>').append($addTagLink2);
    {% else %}
        var $newLinkLi = $('<div class="col-md-12 addItemEst"></div>').append($addTagLink);
        var $newLinkLi2 = $('<div class="col-md-12 addItemEst"></div>').append($addTagLink2);
    {% endif %}
        
    var $delLinkLi = $('#hnr_sircimbundle_estudioradiologicotype_placas.required').append($removeTagLink);
    var $delLinkLi2 = $('#hnr_sircimbundle_estudioradiologicotype_placas.required').append($removeTagLink2);

    function formatRepo (data) {
        if(data.nombre){
            var markup = "<div class='select2-result-repository clearfix'>" +
                         "<div class='select2-result-repository__meta'>" +
                         "<div class='select2-result-repository__title'>" + data.nombre+"</div>" +
                         "</div></div>";
        } else {
            var markup = "Seleccione un tratamiento"; 
        }


        {#if (repo.description) {
          markup += "<div class='select2-result-repository__description'>" + repo.description + "</div>";
        }

        markup += "<div class='select2-result-repository__statistics'>" +
                "<div class='select2-result-repository__forks'><i class='fa fa-flash'></i> " + repo.forks_count + " Forks</div>" +
                "<div class='select2-result-repository__stargazers'><i class='fa fa-star'></i> " + repo.stargazers_count + " Stars</div>" +
                "<div class='select2-result-repository__watchers'><i class='fa fa-eye'></i> " + repo.watchers_count + " Watchers</div>" +
            "</div>" +
            "</div></div>";#}

        return markup;
    }

    function formatRepoSelection (data) {
        if(data.nombre){
            return data.nombre;
        } else {
            return "Seleccione un tratamiento"; 
        }    
    }
    
    
    
    
    
    
    
    $(function () { 
            
            
            $( "#dgplusbellebundle_consulta_estetica" ).on( "change", function() {
                // Se obtiene el id de la plantilla
                var id = $( this ).val();
                $('#idPlantillaEst').show();
                // Se obtiene todos elementos que contengan la clase parametro
                var elements = document.getElementsByClassName('parametro');
                
                // Se borran todos los elementos que se encuentran en el div con id = campos
                $('#campos div').html('');
                
                // Se borran todos los elementos que contengan la clase = parametro
                while(elements.length > 0){
                    elements[0].parentNode.removeChild(elements[0]);
                }
                
                $('#dgplusbellebundle_consulta_campos option').each(function(index, option) {
                    $(option).remove();
                });
                
                // Se obtienen los campos necesarios para la plantilla seleccionada
                $.post( "{{path('admin_busqueda_parametros_estetica')}}", { id: id }, function( data ) {
                    var par = new Array();
                    par = data.query;
                    //console.log(data.query);
                    // Si la consulta de estetica es de Corporal
                    if(data.query[0].estetica == 1){
                        mostrarCamposCorporal(data.query);
                    }
                    // Si la consulta de estetica es de Facial
                    else if(data.query[0].estetica == 2){
                        mostrarCamposFacial(data.query);
                    }
                    // Si la consulta de estetica es de Facial
                    else if(data.query[0].estetica == 3){
                        count = 0;
                        mostrarCamposBotox();
                    }
                }, "json");
                
            });
            
            
            
            
        });
        
        function setCamposPlantilla(id){
            var lista = document.getElementById("dgplusbellebundle_consulta_campos");
            var campoPlantilla = $("#" + id).val();
            var campoNombre = $("#" + id).attr('name');
            var texto = id + '-' + campoNombre + '-' + campoPlantilla;
            
            lista.options.add(new Option(texto));
           
        }//  Fin de setCamposPlantilla
        
        function getCamposPlantilla(){
    
            var lista=document.getElementById("dgplusbellebundle_consulta_campos");
            var camposInfo = new Array();

           if(lista.length>0)
            {
                for(var i=0; i<lista.length; i++)  {
                camposInfo[i] = lista.options[i].text;
                }   

                for ( var i = 0, l = lista.options.length, o; i < l; i++ )
                {
                    o = lista.options[i];
                    if ( camposInfo.indexOf( o.text ) != -1 )
                    {
                        o.selected = true;                
                    }
                } 
                return false; 
            } 
            else {
                  return false;  
            }
        }//Fin de getCamposPlantilla
        
        // Funcion que muestra los campos de texto de la plantilla seleccionada
        function mostrarCampos(data) {
            var div = document.getElementById('campos');
            var form = $("form");
            //console.log(data[0]);
            //var form = document.createElement('form');
            //form.setAttribute('action', '{# {{path('admin_set_campos')}} #}');
            //form.setAttribute('method', 'POST');
            /*-----------*/
            
            var input = new Array();
            var label = new Array();
            var label2 = new Array();
            var campos = new Array();
            var saltos = new Array();
            var etiqueta = new Array();
            var clear = new Array();
            var i = 0;
            
            // Se recorre el array para mostrar los campos
            $.each( data, function( key, value ) {
                //window.print("<div class='col-md-1'>");
                var t = document.createTextNode(value.nombre);
                //window.print("</div");
                
                
                // Se crea un div donde se muestran los parametros
                campos[key] = document.createElement('div');
                campos[key].setAttribute('class', 'parametro col-md-11');
                
                // Se crea el campo de texto del parametro de la plantilla
                if(value.tipoParametro=='Textarea' || value.tipoParametro==''){
                    input[key] = document.createElement('textarea');
                    input[key].setAttribute('type', 'text');
                    input[key].setAttribute('placeholder', value.nombre);
                    input[key].setAttribute('class', 'form-control classPlantilla');
                    input[key].setAttribute('style', 'margin-bottom: 5px;resize:vertical;height:150px;');
                    input[key].setAttribute('name', value.nombre);
                    input[key].setAttribute('id', value.id);
                    
                    etiqueta[key] = document.createElement('p');
                    etiqueta[key].setAttribute('style', 'color: #646473; font-size: 13px; font-weight: 700;');
                    etiqueta[key].appendChild(t);

                    label[key] = document.createElement('label');

                    // Se introducen los elementos en el div con id = campos
                    label[key].appendChild(etiqueta[key]);
                    campos[key].appendChild(label[key]);
                    console.log(input[key]);
                    campos[key].appendChild(input[key]);
                    div.appendChild(campos[key]);
                }
                if(value.tipoParametro=='Radiobutton'){
                    $.post( "{{path('admin_busqueda_opciones_parametros')}}", { id: value.id }, function( opc ) {
                        var par = new Array();
                        par = opc.query;
                        //console.log(par[0]);
                        // Si la plantilla contiene campos
                        $.each( par, function( key2, value2 ) {
                            input[key] = document.createElement('input');
                            input[key].setAttribute('type', 'radio');
                            input[key].setAttribute('class', 'form-control classPlantilla');
                            input[key].setAttribute('name', value.nombre);
                            input[key].setAttribute('id', value.id);

                            etiqueta[key] = document.createElement('p');
                            etiqueta[key].appendChild(t);

                            label[key] = document.createElement('label');

                            // Se introducen los elementos en el div con id = campos
                            label[key].appendChild(etiqueta[key]);
                            campos[key].appendChild(label[key]);
                            
                            campos[key].appendChild(input[key]);
                            $('#'+value.id).append(value2.nombre);
                            div.appendChild(campos[key]);
                        });

                    }, "json");
                    
                    
                }
                if(value.tipoParametro=='Checkbox'){
                    campos[key].setAttribute('class', 'parametro col-md-6');
                    
                    var formgroup = document.createElement('div');
                    formgroup.setAttribute('class', 'form-group');

                    label[key] = document.createElement('label');
                    etiqueta[key] = document.createElement('p');

                    etiqueta[key].setAttribute('style', 'color: #646473; font-size: 13px;');
                    etiqueta[key].appendChild(t);

                    label[key].appendChild(etiqueta[key]);

                    var divLabel = document.createElement('div');
                    formgroup.setAttribute('style', 'margin-bottom: 10px;');

                    divLabel.appendChild(label[key]);
                    formgroup.appendChild(divLabel);
                    
                    $.post( "{{path('admin_busqueda_opciones_parametros')}}", { id: value.id }, function( opc2 ) {
                        var par2 = new Array();
                        par2 = opc2.query;
                        
                        // Si la plantilla contiene campos
                        $.each( par2, function( key3, value3 ) {
                            var chk = document.createElement('div');
                            
                            input[key3] = document.createElement('input');
                            input[key3].setAttribute('type', 'checkbox');
                            input[key3].setAttribute('class', 'form-control');
                            input[key3].setAttribute('name', value.nombre);
                            input[key3].setAttribute('id', value.id);
                            
                            var chk = document.createElement('div');
                            chk.setAttribute('class', 'checkbox');
                            //chk.setAttribute('style', 'margin-top: 10px');
                            //formgroup.appendChild(divLabel);
                            
                            label2[key3] = document.createElement('label');
                            label2[key3].htmlFor = "id";
                            //label2[key3].appendChild(document.createTextNode(value3.nombre));
                           
                            {#var chk = document.createElement('div');
                            chk.setAttribute('class', 'nice-checkbox checkbox-inline');#}
                            
                            chk.appendChild(input[key3]);
                            chk.appendChild(document.createTextNode(value3.nombre));
                            
                            formgroup.appendChild(chk);
                        
                        });
                        console.log(key);
                        campos[key].appendChild(formgroup);
                        div.appendChild(campos[key]);
                        
                        
                        
                        
                        
                    }, "json");
                    if( ((i + 1) % 2) == 0 ) {
                            console.log(((i + 1) % 2)+' '+i);
                            clear[key] = document.createElement('div');
                            clear[key].setAttribute('class', 'clearfix');
                            div.appendChild(clear[key]);
                        }
                }
                
                
                
             //   input[key].setAttribute('onblur', 'setCamposPlantilla(' + value.id + ')');
                
                // Se crea el label del parametro de la plantilla
                
                
                if(((key+1)%3)==0){
                    //console.log(key%3);
                    //console.log(key+' '+(key+1) + '-'+(key+1)%3);
                    saltos[key] = document.createElement('hr');
                    saltos[key] = document.createElement('div');
                    saltos[key].setAttribute('class', 'clearfix');
                    div.appendChild(saltos[key]);
                }
                i++;
            });
            validarConsulta();
        } // Fin de mostrarCampos
        
        // Funcion que muestra los campos de texto de la plantilla seleccionada
        function mostrarCamposCorporal(data) {
            var div = document.getElementById('campos');
            var form = $("form");
            
            var input = new Array();
            var label = new Array();
            var label2 = new Array();
            var campos = new Array();
            var saltos = new Array();
            var etiqueta = new Array();
            var clear = new Array();
            var i = 0;
            
            var comparativo = document.createElement('div');
            comparativo.setAttribute('id', 'comparativoCorp');
            comparativo.setAttribute('class', 'text-right');
            
            var comparativoUrl = document.createElement('a');
            comparativoUrl.setAttribute('id', 'urlComparativoCrp');
            comparativoUrl.setAttribute('style', 'color: blue;');
    
            var comparativoText = document.createTextNode('Ver comparativo');
            var comparativoHr = document.createElement('hr');
            
            comparativoUrl.appendChild(comparativoText);
            
            comparativo.appendChild(comparativoUrl);
            comparativo.appendChild(comparativoHr);
            
            div.appendChild(comparativo);
            
            // Se recorre el array para mostrar los campos
            $.each( data, function( key, value ) {
                var t = document.createTextNode(value.nombre);
                
                // Se crea un div donde se muestran los parametros
                campos[key] = document.createElement('div');
                //campos[key].setAttribute('class', 'parametro col-md-11');
                
                campos[key].setAttribute('class', 'parametro col-md-6');
                campos[key].setAttribute('style', 'margin-top: 15px;');

                var formgroup = document.createElement('div');
                formgroup.setAttribute('class', 'form-group');
                formgroup.setAttribute('style', 'margin-bottom: 10px;');

                label[key] = document.createElement('label');
                
                etiqueta[key] = document.createElement('p');
                etiqueta[key].setAttribute('style', 'color: #646473; font-size: 13px;');
                etiqueta[key].appendChild(t);
                label[key].appendChild(etiqueta[key]);

                var divLabel = document.createElement('div');

                divLabel.appendChild(label[key]);
                formgroup.appendChild(divLabel);
                    
                $.post( "{{path('admin_busqueda_opciones_estetica')}}", { id: value.id }, function( opc2 ) {
                    var par2 = new Array();
                    par2 = opc2.query;

                    // Si la plantilla contiene campos
                    $.each( par2, function( key3, value3 ) {
                        var row = document.createElement('div');
                        var ax = document.createElement('div');
                        var chk = document.createElement('div');
                        var lbl = document.createElement('div');
                        lbl.setAttribute('class', 'lbl col-md-8');
                        lbl.setAttribute('class', 'row');
                        
                        input[key3] = document.createElement('input');
                        input[key3].setAttribute('type', 'checkbox');
                        input[key3].setAttribute('class', 'form-control classCorporal');
                        input[key3].setAttribute('name', value3.nombre);
                        input[key3].setAttribute('id', value3.opcion);
                        input[key3].setAttribute('value', value3.opcion);

                        var chk = document.createElement('div');
                        chk.setAttribute('class', 'checkbox col-md-2');
                        chk.setAttribute('style', 'margin-top: -10px;');
                        label2[key3] = document.createElement('label');
                        label2[key3].htmlFor = "id";

                        chk.appendChild(input[key3]);
                        lbl.appendChild(document.createTextNode(value3.nombre));
                        
                        ax.appendChild(chk);
                        ax.appendChild(lbl);
                        row.appendChild(ax);
                        formgroup.appendChild(row);
                    });

                    console.log(key);
                    campos[key].appendChild(formgroup);
                    div.appendChild(campos[key]);


                }, "json");
                
                if( ((i + 1) % 2) == 0 ) {
                        //console.log(((i + 1) % 2)+' '+i);
                        clear[key] = document.createElement('div');
                        clear[key].setAttribute('class', 'clearfix');
                        div.appendChild(clear[key]);
                }
               
                if(((key+1)%3)==0){
                    //console.log(key%3);
                    //console.log(key+' '+(key+1) + '-'+(key+1)%3);
                    saltos[key] = document.createElement('hr');
                    saltos[key] = document.createElement('div');
                    saltos[key].setAttribute('class', 'clearfix');
                    div.appendChild(saltos[key]);
                }
                i++;
            });
            
            var clearfix = document.createElement('div');
            clearfix.setAttribute('class', 'clearfix');
            div.appendChild(clearfix);
            
            var corporal = document.createElement('div');
            corporal.setAttribute('class', 'col-md-12 corporal');
            corporal.setAttribute('style', 'margin-bottom: 15px;');
            
            var rowCorp = document.createElement('div');
            rowCorp.setAttribute('class', 'row');
            
            // Elemento para registrar peso 
            var formgroupCrpPeso = document.createElement('div');
            formgroupCrpPeso.setAttribute('class', 'form-group col-md-4');
            formgroupCrpPeso.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelPeso = document.createElement('label');
            var etiquetaPeso = document.createElement('p');
            etiquetaPeso.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaPeso.appendChild(document.createTextNode('Peso'));
            labelPeso.appendChild(etiquetaPeso);
            var divLabelPeso = document.createElement('div');
            divLabelPeso.appendChild(labelPeso);
            formgroupCrpPeso.appendChild(divLabelPeso);
            
            var inputPeso = document.createElement('input');
            inputPeso.setAttribute('type', 'text');
            inputPeso.setAttribute('class', 'form-control corporall');
            inputPeso.setAttribute('name', 'corporal[peso]');
            inputPeso.setAttribute('id', 'peso');
            //inputPeso.setAttribute('value', value3.opcion);
            formgroupCrpPeso.appendChild(inputPeso);
            rowCorp.appendChild(formgroupCrpPeso);
            //corporal.appendChild(rowCorp);  
            //div.appendChild(corporal);
            
            // Elemento para registrar Grasa corporal
            var formgroupCrpGrasaCorp = document.createElement('div');
            formgroupCrpGrasaCorp.setAttribute('class', 'form-group col-md-4');
            formgroupCrpGrasaCorp.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelGrasaCorp = document.createElement('label');
            var etiquetaGrasaCorp = document.createElement('p');
            etiquetaGrasaCorp.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaGrasaCorp.appendChild(document.createTextNode('Grasa corporal'));
            labelGrasaCorp.appendChild(etiquetaGrasaCorp);
            var divLabelGrasaCorp = document.createElement('div');
            divLabelGrasaCorp.appendChild(labelGrasaCorp);
            formgroupCrpGrasaCorp.appendChild(divLabelGrasaCorp);
            
            var inputGrasaCorp = document.createElement('input');
            inputGrasaCorp.setAttribute('type', 'text');
            inputGrasaCorp.setAttribute('class', 'form-control corporall');
            inputGrasaCorp.setAttribute('name', 'corporal[grasa_corporal]');
            inputGrasaCorp.setAttribute('id', 'grasa_corporal');
            
            formgroupCrpGrasaCorp.appendChild(inputGrasaCorp);
            rowCorp.appendChild(formgroupCrpGrasaCorp);
            //corporal.appendChild(rowCorp);  
            //div.appendChild(corporal);
            
            // Elemento para registrar Agua Corporal
            var formgroupCrpAguaCorp = document.createElement('div');
            formgroupCrpAguaCorp.setAttribute('class', 'form-group col-md-4');
            formgroupCrpAguaCorp.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelAguaCorp = document.createElement('label');
            var etiquetaAguaCorp = document.createElement('p');
            etiquetaAguaCorp.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaAguaCorp.appendChild(document.createTextNode('Agua corporal'));
            labelAguaCorp.appendChild(etiquetaAguaCorp);
            var divLabelAguaCorp = document.createElement('div');
            divLabelAguaCorp.appendChild(labelAguaCorp);
            formgroupCrpAguaCorp.appendChild(divLabelAguaCorp);
            
            var inputAguaCorp = document.createElement('input');
            inputAguaCorp.setAttribute('type', 'text');
            inputAguaCorp.setAttribute('class', 'form-control corporall');
            inputAguaCorp.setAttribute('name', 'corporal[agua_corporal]');
            inputAguaCorp.setAttribute('id', 'agua_corporal');
            
            formgroupCrpAguaCorp.appendChild(inputAguaCorp);
            rowCorp.appendChild(formgroupCrpAguaCorp);
            
            // Elemento para registrar Masa musculo
            var formgroupCrpMMusculo = document.createElement('div');
            formgroupCrpMMusculo.setAttribute('class', 'form-group col-md-4');
            formgroupCrpMMusculo.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelMMusculo = document.createElement('label');
            var etiquetaMMusculo = document.createElement('p');
            etiquetaMMusculo.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaMMusculo.appendChild(document.createTextNode('Masa musculo'));
            labelMMusculo.appendChild(etiquetaMMusculo);
            var divLabelMMusculo = document.createElement('div');
            divLabelMMusculo.appendChild(labelMMusculo);
            formgroupCrpMMusculo.appendChild(divLabelMMusculo);
            
            var inputMMusculo = document.createElement('input');
            inputMMusculo.setAttribute('type', 'text');
            inputMMusculo.setAttribute('class', 'form-control corporall');
            inputMMusculo.setAttribute('name', 'corporal[masa_musculo]');
            inputMMusculo.setAttribute('id', 'masa_musculo');
            
            formgroupCrpMMusculo.appendChild(inputMMusculo);
            rowCorp.appendChild(formgroupCrpMMusculo);
            
            // Elemento para registrar Valoracion fisica
            var formgroupCrpValFisica = document.createElement('div');
            formgroupCrpValFisica.setAttribute('class', 'form-group col-md-4');
            formgroupCrpValFisica.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelValFisica = document.createElement('label');
            var etiquetaValFisica = document.createElement('p');
            etiquetaValFisica.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaValFisica.appendChild(document.createTextNode('Valoracion Fisica'));
            labelValFisica.appendChild(etiquetaValFisica);
            var divLabelValFisica = document.createElement('div');
            divLabelValFisica.appendChild(labelValFisica);
            formgroupCrpValFisica.appendChild(divLabelValFisica);
            
            var inputValFisica = document.createElement('input');
            inputValFisica.setAttribute('type', 'text');
            inputValFisica.setAttribute('class', 'form-control corporall');
            inputValFisica.setAttribute('name', 'corporal[valoracion_fisica]');
            inputValFisica.setAttribute('id', 'valoracion_fisica');
            
            formgroupCrpValFisica.appendChild(inputValFisica);
            rowCorp.appendChild(formgroupCrpValFisica);
            
            // Elemento para registrar DCI / BMR
            var formgroupCrpDCIBMR = document.createElement('div');
            formgroupCrpDCIBMR.setAttribute('class', 'form-group col-md-4');
            formgroupCrpDCIBMR.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelDCIBMR = document.createElement('label');
            var etiquetaDCIBMR = document.createElement('p');
            etiquetaDCIBMR.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaDCIBMR.appendChild(document.createTextNode('DCI / BMR'));
            labelDCIBMR.appendChild(etiquetaDCIBMR);
            var divLabelDCIBMR = document.createElement('div');
            divLabelDCIBMR.appendChild(labelDCIBMR);
            formgroupCrpDCIBMR.appendChild(divLabelDCIBMR);
            
            var inputDCIBMR = document.createElement('input');
            inputDCIBMR.setAttribute('type', 'text');
            inputDCIBMR.setAttribute('class', 'form-control corporall');
            inputDCIBMR.setAttribute('name', 'corporal[dci_bmr]');
            inputDCIBMR.setAttribute('id', 'dci_bmr');
            
            formgroupCrpDCIBMR.appendChild(inputDCIBMR);
            rowCorp.appendChild(formgroupCrpDCIBMR);
            
            // Elemento para registrar Edad metabolica
            var formgroupCrpEdadMet = document.createElement('div');
            formgroupCrpEdadMet.setAttribute('class', 'form-group col-md-4');
            formgroupCrpEdadMet.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelEdadMet = document.createElement('label');
            var etiquetaEdadMet = document.createElement('p');
            etiquetaEdadMet.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaEdadMet.appendChild(document.createTextNode('Edad metabolica'));
            labelEdadMet.appendChild(etiquetaEdadMet);
            var divLabelEdadMet = document.createElement('div');
            divLabelEdadMet.appendChild(labelEdadMet);
            formgroupCrpEdadMet.appendChild(divLabelEdadMet);
            
            var inputEdadMet = document.createElement('input');
            inputEdadMet.setAttribute('type', 'text');
            inputEdadMet.setAttribute('class', 'form-control corporall');
            inputEdadMet.setAttribute('name', 'corporal[edad_metabolica]');
            inputEdadMet.setAttribute('id', 'edad_metabolica');
            
            formgroupCrpEdadMet.appendChild(inputEdadMet);
            rowCorp.appendChild(formgroupCrpEdadMet);
            
            // Elemento para registrar Masa osea
            var formgroupCrpMasaOsea = document.createElement('div');
            formgroupCrpMasaOsea.setAttribute('class', 'form-group col-md-4');
            formgroupCrpMasaOsea.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelMasaOsea = document.createElement('label');
            var etiquetaMasaOsea = document.createElement('p');
            etiquetaMasaOsea.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaMasaOsea.appendChild(document.createTextNode('Masa Osea'));
            labelMasaOsea.appendChild(etiquetaMasaOsea);
            var divLabelMasaOsea = document.createElement('div');
            divLabelMasaOsea.appendChild(labelMasaOsea);
            formgroupCrpMasaOsea.appendChild(divLabelMasaOsea);
            
            var inputMasaOsea = document.createElement('input');
            inputMasaOsea.setAttribute('type', 'text');
            inputMasaOsea.setAttribute('class', 'form-control corporall');
            inputMasaOsea.setAttribute('name', 'corporal[masa_osea]');
            inputMasaOsea.setAttribute('id', 'masa_osea');
            
            formgroupCrpMasaOsea.appendChild(inputMasaOsea);
            rowCorp.appendChild(formgroupCrpMasaOsea);
            
            // Elemento para registrar Grasa visceral
            var formgroupCrpGrVisceral = document.createElement('div');
            formgroupCrpGrVisceral.setAttribute('class', 'form-group col-md-4');
            formgroupCrpGrVisceral.setAttribute('style', 'margin-bottom: 10px;');
            
            var labelGrVisceral = document.createElement('label');
            var etiquetaGrVisceral = document.createElement('p');
            etiquetaGrVisceral.setAttribute('style', 'color: #646473; font-size: 13px;');
            etiquetaGrVisceral.appendChild(document.createTextNode('Grasa visceral'));
            labelGrVisceral.appendChild(etiquetaGrVisceral);
            var divLabelGrVisceral = document.createElement('div');
            divLabelGrVisceral.appendChild(labelGrVisceral);
            formgroupCrpGrVisceral.appendChild(divLabelGrVisceral);
            
            var inputGrVisceral = document.createElement('input');
            inputGrVisceral.setAttribute('type', 'text');
            inputGrVisceral.setAttribute('class', 'form-control corporall');
            inputGrVisceral.setAttribute('name', 'corporal[grasa_visceral]');
            inputGrVisceral.setAttribute('id', 'grasa_visceral');
            
            formgroupCrpGrVisceral.appendChild(inputGrVisceral);
            rowCorp.appendChild(formgroupCrpGrVisceral);
            
            corporal.appendChild(rowCorp);  
            div.appendChild(corporal);
            
            var clearfix = document.createElement('div');
            clearfix.setAttribute('class', 'clearfix');
            div.appendChild(clearfix);
            
            validarConsultaEstetica();
            validarConsulta();
        } // Fin de mostrarCampos
    
    
    
    
    
    
    
    
    
    

    jQuery(document).ready(function() {
    
    
    
        $(document).on('change','#busquedaPacienteConsulta',function(){
            var id = $(this).val();
            
            var myAwesomeDropzone = $('#formImagen');
            
            Dropzone.options.myAwesomeDropzone = {
                paramName: "file", // The name that will be used to transfer the file
                
                maxFilesize: 2, // MB
                accept: function(file, done) {
                  if (file.name == "justinbieber.jpg") {
                    done("Naha, you don't.");
                  }
                  else { done(); }
                }
            };
            //limpiar campos de consultas
            $('#idConsulta').val('');
            $('#costoConsulta').val('');
            $('#observacionConsulta').val('');
            
            ///limpiar campos de signos
            $('#tipo_consulta').val(0).change();
            $('#pesoPaciente').val('');
            $('#tallaPaciente').val('');
            $('#frecRespiratoria').val('');
            $('#presionSistolica').val('');
            $('#presionDiastolica').val('');
            $('#temperaturaPaciente').val('');
            $('#frecCardiaca').val('');
            
            
            //$('#planOpciones input').prop('checked','false');
            $('#selectPlantilla0').click();
            $('#selectPlantilla0,#selectPlantilla1').prop('checked','false');
            $('#selectPlantilla0,#selectPlantilla1').removeAttr('checked');
            //se ocultan las historias clinicas
            $('.LPB,.SD').hide();
            
            //limpiamos campo receta
            $('#receta').val('');
            
            //limpimos las imágenes
            $('.imagenMensaje').show();
            $('.imagenContent').addClass('hidden');
            
        
        
            {#$('#formImagen').remove();
            var formulario = '<form class=\"dropzone\" id=\"formImagen\" role=\"form\" enctype=\"multipart/form-data\" method=\"post\" action=\"/lpbsistema/app_dev.php/admin/consulta/ingresar_foto_persona/get?id=\"><div class=\"fallback\"><input name=\"file[]\" type=\"file\" multiple required id=\"file-input\"/></div><input type=\"text\" id=\"idConsulta\" value=\"\" name=\"idConsulta\" class=\"hidden form-control input-sm\"/></form>';
            $('.imagenContent').children().html(formulario);#}
            
            console.log('id de paciente: '+id);
            $.ajax({
                data:{'id':id
                },
                url:"{{path('busqueda_paciente_info_exp')}}",
                type: "post",
                success: function (data) {
                    
                    //var dat = JSON.parse(data);
                    console.log(data);
                    $('#nombresPaciente').val(data.data[0].nombres);
                    $('#apellidosPaciente').val(data.data[0].apellidos);
                    $('#telefono1').val(data.data[0].telefono);
                    $('#telefono2').val(data.data[0].telefono2);
                    $('#direccion').val(data.data[0].direccion);
                    $('#correo').val(data.data[0].email);
                    $('#dui').val(data.data[0].dui);
                    
                    $('#estadoCivil').val(data.data[0].estadoCivil).change();
                    $('#sexo').val(data.data[0].sexo).change();
                    
                    $('#ocupacion').val(data.data[0].ocupacion);
                    $('#lugarTrabajo').val(data.data[0].lugarTrabajo);
                    var fecha=data.data[0].fechaNacimiento;
                    var fechaD="";
                    if(fecha!=null){
                        fechaD = fecha.toString();
                    }
                    else{
                        fechaD = "N/A";
                    }
                    {#console.log(fecha);
                    console.log(fechaD);#}
                    $('#fechaNacimiento').val(fecha);
{#                    console.log(dat[0].fechaNacimiento);#}
    
                    $('#referidoPor').val(data.data[0].referidoPor);
                    $('#llamarA').val(data.data[0].personaEmergencia);
                    $('#telefonoEmergencia').val(data.data[0].telefonoEmergencia);
                    $('#nombrePaciente').html(data.data[0].nombres+" "+data.data[0].apellidos);
                    $('#expediente').html('<i class=\"fa fa-clipboard\"></i> <a style=\"color:#FFF;text-decoration: underline;\" href=\"'+Routing.generate('admin_consulta_expediente_sd')+"?id="+data.data[0].numero+'\">'+data.data[0].numero+'</a>');
                    $('#ocupacionPaciente').html('<i class=\"fa fa-briefcase\"></i> '+data.data[0].cupacion);
                    $('#telefono').html('<i class=\"fa fa-phone\"></i> '+data.data[0].telefono);
                    $('#direccionD').html('<i class="fa fa-map-marker fa-fw"></i> '+data.data[0].direccion);
                    $('#edad').html('<i class="fa fa-birthday-cake"></i> '+data.edad);
                    
                    $('#antecedentesPatologicos').val(data.data[0].patologicos);
                    $('#antecedentesFamiliares').val(data.data[0].familiares);
                    $('#antecedentesAlergias').val(data.data[0].alergias);
                    
                    $('#idPaciente').val(data.data[0].id);
                    $('#info-Paciente').show();
                },
                error: function (data) {
                    swal('','Ocurrió un error, seleccione un paciente de nuevo!','error');
                }
            });
            //console.log('vdfsvfdv');
        });
    
    
    
    
        var busqueda = $('#busquedaPacienteConsulta').select2({
                                    
            ajax: {
                url: "{{path('busqueda_paciente_select_exp')}}",
                dataType: 'json',
                delay: 250,
                data: function (params) {
                    return {
                        q: params.term, 
                        page: params.page
                    };
                },
                processResults: function (data, params) {
                    var select2Data = $.map(data.data, function (obj) {
                        obj.id = obj.numero;
                        obj.text = obj.numero+" "+obj.nombres+" "+obj.apellidos;

                        return obj;
                    });

                    return {
                        results: select2Data
                        {#pagination: {
                            more: (params.page * 30) < data.total_count
                        }#}
                    };
                },
                cache: true
            },
            escapeMarkup: function (markup) { return markup; }, 
            minimumInputLength: 1,
            templateResult: formatRepoPac, 
            templateSelection: formatRepoSelectionPac
        });
    
        
        function formatRepoPac (data) {
            if(data.numero){
                var markup = "<div class='select2-result-repository clearfix'>" +
                             "<div class='select2-result-repository__meta'>" +
                             "<div class='select2-result-repository__title'>" + data.numero+" | "+data.nombres+" "+data.apellidos+"</div>" +
                             "</div></div>";
            } else {
                var markup = "Buscar paciente..."; 
            }


            {#if (repo.description) {
              markup += "<div class='select2-result-repository__description'>" + repo.description + "</div>";
            }

            markup += "<div class='select2-result-repository__statistics'>" +
                    "<div class='select2-result-repository__forks'><i class='fa fa-flash'></i> " + repo.forks_count + " Forks</div>" +
                    "<div class='select2-result-repository__stargazers'><i class='fa fa-star'></i> " + repo.stargazers_count + " Stars</div>" +
                    "<div class='select2-result-repository__watchers'><i class='fa fa-eye'></i> " + repo.watchers_count + " Watchers</div>" +
                "</div>" +
                "</div></div>";#}

            return markup;
        }

        function formatRepoSelectionPac (data) {
            if(data.numero){
                return data.numero+" | "+data.nombres+" "+data.apellidos;
            } else {
                return "Buscar paciente..."; 
            }    
        }
        
        
        
        function calcular_edad(fecha){

        //calculo la fecha de hoy
        var hoy=new Date();
        //alert(hoy)

        //calculo la fecha que recibo
        //La descompongo en un array
        var array_fecha = fecha.split("-")
        //si el array no tiene tres partes, la fecha es incorrecta
        if (array_fecha.length!=3)
           return false

        //compruebo que los ano, mes, dia son correctos
        var ano
        ano = parseInt(array_fecha[2]);
        if (isNaN(ano))
           return false

        var mes
        mes = parseInt(array_fecha[1]);
        if (isNaN(mes))
           return false

        var dia
        dia = parseInt(array_fecha[0]);
        if (isNaN(dia))
           return false


        //si el año de la fecha que recibo solo tiene 2 cifras hay que cambiarlo a 4
        if (ano<=99)
           ano +=1900

        //resto los años de las dos fechas
        var edad=hoy.getYear()- ano - 1; //-1 porque no se si ha cumplido años ya este año

        //si resto los meses y me da menor que 0 entonces no ha cumplido años. Si da mayor si ha cumplido
        if (hoy.getMonth() + 1 - mes < 0) //+ 1 porque los meses empiezan en 0
           return edad
        if (hoy.getMonth() + 1 - mes > 0)
           return edad+1

        //entonces es que eran iguales. miro los dias
        //si resto los dias y me da menor que 0 entonces no ha cumplido años. Si da mayor o igual si ha cumplido
        if (hoy.getUTCDate() - dia >= 0)
           return edad + 1

        return edad
    } 
    
    
        $('#dui').mask('00000000-0');  
        $('#telefono1').mask('0000-0000'); 
        $('#telefono2').mask('0000-0000'); 
        $('#telefonoEmergencia').mask('0000-0000'); 
        
        $('.calBotox').Zebra_DatePicker({
            months:['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            days: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'],
            format: 'd-m-Y',
            show_clear_date:false,
            show_select_today: "Hoy",
        });
        
        $(document).on('click','.selectPlantilla', function(){
            var valorPlantilla=$(this).val();
            console.log(valorPlantilla);
            var elements = document.getElementsByClassName('parametro');
            if(valorPlantilla==0){
                $('.SD').show();
                $('.LPB').hide();
                
                
                // Se borran todos los elementos que se encuentran en el div con id = campos
                $('#campos div').html('');
                
                // Se borran todos los elementos que contengan la clase = parametro
                while(elements.length > 0){
                    elements[0].parentNode.removeChild(elements[0]);
                }
                
                $('#dgplusbellebundle_consulta_campos option').each(function(index, option) {
                    $(option).remove();
                });
            }
            else{
                $('.LPB').show();
                $('.SD').hide();
                
                // Se borran todos los elementos que se encuentran en el div con id = campos
                $('#campos div').html('');
                
                // Se borran todos los elementos que contengan la clase = parametro
                while(elements.length > 0){
                    elements[0].parentNode.removeChild(elements[0]);
                }
                
                $('#dgplusbellebundle_consulta_campos option').each(function(index, option) {
                    $(option).remove();
                });
            }
        });
            
        $('#costoConsulta').val('{{consulta.costoConsulta}}');
        $(document).on('click','.generarPDF', function(){
            var href = $(this).attr('href');
            window.open(href,'_blank');
            //alert();
            return false;
        });    
        {#$(document).on('click','#historialPrevPDF', function(){
            
            return false;            
        });#}
            
            
            
            
        /**********************************************
         * Metodos de guardar con ajax
         */
        $(document).on('click','#guardarNuevoDatosGenerales', function(){
            var id = $('#idPaciente').val();
            var nombres = $('#nombresPaciente').val();
            var apellidos = $('#apellidosPaciente').val();
            var telefono1= $('#telefono1').val();
            var telefono2= $('#telefono2').val();
            var direccion = $('#direccion').val();
            var correo= $('#correo').val();
            var dui= $('#dui').val();
            var estadoCivil= $('#estadoCivil').val();
            var sexo = $('#sexo').val();
            var ocupacion = $('#ocupacion').val();
            var lugarTrabajo= $('#lugarTrabajo').val();
            var fechaNacimiento = $('#fechaNacimiento').val();
            var referidoPor= $('#referidoPor').val();
            var llamarA= $('#llamarA').val();
            var telefonoEmergencia = $('#telefonoEmergencia').val();
            
           
{#            alert(direccion);#}
            
            //alert(fechaNacimiento);
            if(id===''){
                swal('','Debe seleccionar un paciente','error');
                return false;
            }
            if(nombres==='' || apellidos==='' || telefono1===''){
                swal('','El nombre, apellidos y teléfono1 no pueden quedar en vacios','error');
                return false;
            }
            
            
            $.ajax({
                data:{id:id,nombres:nombres,apellidos:apellidos,telefono1:telefono1,telefono2:telefono2,direccion:direccion,correo:correo,dui:dui,estadoCivil:estadoCivil,sexo:sexo,ocupacion:ocupacion,
                    lugarTrabajo:lugarTrabajo,fechaNacimiento:fechaNacimiento, referidoPor:referidoPor, llamarA:llamarA, telefonoEmergencia:telefonoEmergencia
                },
                url:"{{path('admin_paciente_guardar_ajax')}}",
                type: "post",
                success: function (data) {
                        //inicio = data.inicio++;
                        if(data==0){
                            var iTel='<i class="fa fa-phone"></i>';
                            var dir='<i class="fa fa-map-marker fa-fw"></i>';
                            var ocup = '<i class="fa fa-briefcase"></i>';
                            $('#telefono').html(iTel+" "+telefono1);
                            $('#direccionD').html(dir+" "+direccion);

                            
                            $('#nombrePaciente').html(nombres+" "+apellidos);
                            $('#ocupacionPaciente').html(ocup+" "+ocupacion);
{#                            bootbox.alert("Cambios guardados!", function() {});#}
                            {#alertify.success("Cambios guardados!");#}
                            swal('','Cambios guardados!','success');
                        }
                        
                        {#console.log("pagina actual: "+data);
                        console.log("Inicio de registro: "+data.inicioRegistro);#}
                    },
                error: function (data) {


                }
            });
        });
        
        
        
        var idconsulta=$('#idConsulta').val();
        $(document).on('click','#guardarNuevoConsulta', function(){
            $("#guardarNuevoConsulta").prop('disabled', true);
            var id = $('#idPaciente').val();
            var medico = $('#medico_consulta').val();
            
            var tratamiento = $('#tratamiento_consulta').val();
            var tipoConsulta = $('#tipo_consulta').val();
            var sucursal = $('#sucursal_consulta').val();
            var observaciones = $('#observacionConsulta').val();
            idconsulta=$('#idConsulta').val();
            var costoconsulta=$('#costoConsulta').val();
            //alert(medico+","+tratamiento+","+tipoConsulta+","+observaciones+","+sucursal);
            
            
            if(id===''){
                swal('','Debe seleccionar un paciente','error');
                $("#guardarNuevoConsulta").prop('disabled', false);
                return false;
            }
{#            alert(medico);#}
            
            //return false;
            
            {#if(tratamiento==0){
                bootbox.alert("Debe seleccionar un tratamiento!", function() {});
            }
            else{#}
                if(tipoConsulta==0){
                    {#bootbox.alert("Debe seleccionar un tipo de consulta!", function() {});#}
                    swal('','Debe seleccionar un tipo de consulta!','error');
                    $("#guardarNuevoConsulta").prop('disabled', false);
                    return false;
                }
                else{
                    if(idconsulta!=''){
                        {#bootbox.confirm("Desea registrar esta consulta para el paciente?", function(result) {#}
                            {#Example.show("Confirm result: "+result);#}
{#                            if(result){#}
                                //console.log(result);
                                $.ajax({
                                    data:{id:id,medico:medico,tipoConsulta:tipoConsulta,sucursal:sucursal,observaciones:observaciones,idconsulta:idconsulta,costoconsulta:costoconsulta},
                                    url:"{{path('admin_consulta_actualizar_ajax')}}",
                                    type: "post",
                                    success: function (data) {
                                            //inicio = data.inicio++;
                                            if(data!=0){
                                                $('#idConsulta').val(data);
                                                console.log(data);
{#                                                bootbox.alert("Consulta registrada!", function() {});#}
                                                {#alertify.success("Consulta actualizada!");#}
                                                swal('','Consulta actualizada!','success');
                                                $('.imagenMensaje').addClass('hidden');
                                                $('.imagenContent').removeClass('hidden');
                                                console.log($('#idConsulta').val());
                                                $("#guardarNuevoConsulta").prop('disabled', false);
                                            }
                                        },
                                    error: function (data) {
                                        $("#guardarNuevoConsulta").prop('disabled', false);
                                    }
                                });
{#                            }#}
                            {#else{
                                //console.log(result);
                            }#}
{#                        }); #}
                    }
                    else{
{#                        bootbox.alert("!", function() {});#}
                        swal({
                            title: "Esperando confirmación...",
                            text: "Desea registrar esta consulta para el paciente?",
                            type: "info",
                            showCancelButton: true,
                            {#confirmButtonColor: "#1D234D",#}
                            confirmButtonText: "Aceptar",
                            cancelButtonText: "Cancelar",
                            closeOnConfirm: false,
                            closeOnCancel: false
                        }).then(function(isConfirm) {
                            if (isConfirm) {
                                //console.log(result);
                                $.ajax({
                                    data:{id:id,medico:medico,tratamiento:tratamiento,tipoConsulta:tipoConsulta,sucursal:sucursal,observaciones:observaciones,costoconsulta:costoconsulta},
                                    url:"{{path('admin_consulta_guardar_ajax')}}",
                                    type: "post",
                                    success: function (data) {
                                            //inicio = data.inicio++;
                                            if(data!=0){
                                                $('#idConsulta').val(data);
                                                console.log(data);
{#                                                bootbox.alert("Consulta registrada!", function() {});#}
                                                {#alertify.success("Consulta registrada!");#}
                                                swal('','Consulta registrada!','success');
                                                $('.imagenMensaje').addClass('hidden');
                                                $('.imagenContent').removeClass('hidden');
                                                var action = $('#formImagen').attr('action');
                                                $('#formImagen').attr('action',action+data);
                                                
                                                $("#guardarNuevoConsulta").prop('disabled', false);
                                                console.log($('#idConsulta').val());
                                            }
                                        },
                                    error: function (data) {
                                        $("#guardarNuevoConsulta").prop('disabled', false);
                                    }
                                });
                            } else {
                                $("#guardarNuevoConsulta").prop('disabled', false);
                            }
                        });


                        {#bootbox.confirm("Desea registrar esta consulta para el paciente?", function(result) {
                            
                            if(result){
                                //console.log(result);
                                $.ajax({
                                    data:{id:id,medico:medico,tratamiento:tratamiento,tipoConsulta:tipoConsulta,sucursal:sucursal,observaciones:observaciones,costoconsulta:costoconsulta},
                                    url:"{{path('admin_consulta_guardar_ajax')}}",
                                    type: "post",
                                    success: function (data) {
                                            //inicio = data.inicio++;
                                            if(data!=0){
                                                $('#idConsulta').val(data);
                                                console.log(data);
{#                                                bootbox.alert("Consulta registrada!", function() {});}
                                                
                                                swal('','Consulta registrada!','success');
                                                $('.imagenMensaje').addClass('hidden');
                                                $('.imagenContent').removeClass('hidden');
                                                var action = $('#formImagen').attr('action');
                                                $('#formImagen').attr('action',action+data);  
                                                console.log($('#idConsulta').val());
                                            }
                                        },
                                    error: function (data) {
                                    }
                                });
                            }
                            else{
                                //console.log(result);
                            }
                        }); #}
                    }
                }
{#            }#}
            
        });
        console.log('imagen: '+idconsulta);
        if(idconsulta!==''){
            $('.imagenMensaje').addClass('hidden');
            $('.imagenContent').removeClass('hidden');
            
             
        }
        
        $(document).on('click','#guardarAntecedentes', function(){
            var id = $('#idPaciente').val();
            var patologicos = $('#antecedentesPatologicos').val();
            var familiares = $('#antecedentesFamiliares').val();
            var alergias = $('#antecedentesAlergias').val();
            {#console.log(patologicos);
            console.log(familiares);
            console.log(alergias);#}
            //alert(fechaNacimiento);
            if(id===''){
                swal('','Debe seleccionar un paciente','error');
                return false;
            }
            $.ajax({
                data:{id:id,patologicos:patologicos,familiares:familiares,alergias:alergias},
                url:"{{path('admin_paciente_guardar_antecedentes_ajax')}}",
                type: "post",
                success: function (data) {
                        //inicio = data.inicio++;
                        if(data==0){
{#                            bootbox.alert("Cambios guardados!", function() {});#}
                            {#alertify.success("Antecedentes guardados!");#}
                            swal('','Antecedentes guardados!','success');
                        }
                        
                        {#console.log("pagina actual: "+data);
                        console.log("Inicio de registro: "+data.inicioRegistro);#}
                    },
                error: function (data) {

                }
            });
        });
        
        
        
        $(document).on('click','#guardarSignosConsulta', function(){
            $("#guardarSignosConsulta").prop('disabled', true);
            var id = $('#idPaciente').val();
            var idConsulta = $('#idConsulta').val();
            var peso = $('#pesoPaciente').val();
            var talla = $('#tallaPaciente').val();
            var frecRespiratoria = $('#frecRespiratoria').val();
            var presionDiastolica = $('#presionDiastolica').val();
            var presionSistolica= $('#presionSistolica').val();
            var temperatura = $('#temperaturaPaciente').val();
            var frecCardiaca = $('#frecCardiaca').val();
            var medico = $('#medico_consulta').val();
            var sucursal = $('#sucursal_consulta').val();
            if(id===''){
                swal('','Debe seleccionar un paciente','error');
                return false;
            }
            
            if(idConsulta==''){
                $.ajax({
                    data:{sucursal:sucursal,medico:medico,id:id,peso:peso,talla:talla,frecRespiratoria:frecRespiratoria,presionDiastolica:presionDiastolica,presionSistolica:presionSistolica,temperatura:temperatura,frecCardiaca:frecCardiaca},
                    url:"{{path('admin_paciente_guardar_signos_ajax')}}",
                    type: "post",
                    success: function (data) {
                            //inicio = data.inicio++;
                            if(data!=0){
    {#                            bootbox.alert("Cambios guardados!", function() {});#}
                                {#alertify.success("Signos vitales guardados!");#}
                                swal('','Signos vitales guardados!','success');
                                $('.imagenMensaje').addClass('hidden');
                                $('.imagenContent').removeClass('hidden');
                                $('#idConsulta').val(data);
                                var action = $('#formImagen').attr('action');
                                $('#formImagen').attr('action',action+data);
                                
                                $("#guardarSignosConsulta").prop('disabled', false);
                            }
    {#                        console.log("pagina actual: "+data);
                            console.log("Inicio de registro: "+data.inicioRegistro);#}
                                                    

                        },
                    error: function (data) {
                        $("#guardarSignosConsulta").prop('disabled', false);

                    }
                });
            }
            else{
                $.ajax({
                    data:{idConsulta:idConsulta,id:id,peso:peso,talla:talla,frecRespiratoria:frecRespiratoria,presionDiastolica:presionDiastolica,presionSistolica:presionSistolica,temperatura:temperatura,frecCardiaca:frecCardiaca},
                    url:"{{path('admin_paciente_actualizar_signos_ajax')}}",
                    type: "post",
                    success: function (data) {
                            //inicio = data.inicio++;
                            if(data!=0){
    {#                            bootbox.alert("Cambios guardados!", function() {});#}
                                {#alertify.success("Signos vitales actualizados!");#}
                                swal('','Signos vitales actualizados!','success');
                                $('.imagenMensaje').addClass('hidden');
                                $('.imagenContent').removeClass('hidden');
                                $('#idConsulta').val(data);

                                $("#guardarSignosConsulta").prop('disabled', false);
                            }
    {#                        console.log("pagina actual: "+data);
                            console.log("Inicio de registro: "+data.inicioRegistro);#}

                        },
                    error: function (data) {
                        $("#guardarSignosConsulta").prop('disabled', false);

                    }
                });
            }
        });
        
        
        
        
        
        $(document).on('click','#guardarCostoConsulta', function(){
            var idConsulta = $('#idConsulta').val();
            var costoConsulta = $('#costoConsulta').val();
            if(idConsulta!=''){
                $.ajax({
                    data:{idConsulta:idConsulta,costo:costoConsulta},
                    url:"{{path('admin_consulta_guardar_costo_ajax')}}",
                    type: "post",
                    success: function (data) {
                            //inicio = data.inicio++;
                            if(data==0){
                                {#alertify.success("Costo de consulta guardado!");#}
                                swal('','Costo de consulta guardado!','success');
                            }
                            else{
                                {#alertify.error("Hubo un error, intente de nuevo!");#}
                                swal('','Hubo un error, intente de nuevo!','error');
                            }
    {#                        console.log("pagina actual: "+data);
                            console.log("Inicio de registro: "+data.inicioRegistro);#}

                        },
                    error: function (data) {
                        {#alertify.error("Hubo un error, intente de nuevo!");#}
                        swal('','Hubo un error, intente de nuevo!','error');
                        {#bootbox.alert("Hubo un error, intente de nuevo!", function() {});#}
                    }
                });
            }
            else{
{#                alertify.error("Debe ingresar una consulta primero!");#}
                {#bootbox.alert("Debe ingresar una consulta primero!", function() {});#}
                swal('','Ingrese una consulta!','error');
            }
        });
        
        
        
        
        
        $(document).on('click','#guardarPlantilla', function(){
            var id = $('#idPaciente').val();
            var idConsulta = $('#idConsulta').val();
            if(id===''){
                swal('','Debe seleccionar un paciente','error');
                return false;
            }
{#            alert(direccion);#}
            $('.guardarPlantilla').hide();
            var valores = new Array();
            var idParameters = new Array();
            var idPlantilla= $('#dgplusbellebundle_consulta_plantilla').val();
            $('.classPlantilla').each(function(index,element){
                var valor = $(this).val();
                var ids = $(this).attr('id');
                valores.push(valor);
                idParameters.push(ids);
                
            });
            //alert(fechaNacimiento);
            
{#            url:"{{path('admin_consulta_insert_plantilla',{'id':id})}},#}
{#            alert(idConsulta);#}
    //sonodigest
            if($('#selectPlantilla0').is(':checked')){
                    if(idConsulta!=''){
                        $.ajax({
                            data:{id:id,valores:valores,idConsulta:idConsulta,idParameters:idParameters,idPlantilla:idPlantilla
                            },
                            url:"{{path('admin_consulta_insert_plantilla')}}",
                            type: "post",
                            success: function (data) {
                                    //inicio = data.inicio++;
                                    console.log(data);
                                    if(data==0){
                                        var iTel='<i class="fa fa-phone"></i>';
                                        var dir='<i class="fa fa-map-marker fa-fw"></i>';
                                        var ocup = '<i class="fa fa-briefcase"></i>';
                                        $('#telefono').html(iTel+" "+telefono1);
                                        $('#direccionD').html(dir+" "+direccion);
                                        $('#nombrePaciente').html(nombres+" "+apellidos);
                                        $('#ocupacionPaciente').html(ocup+" "+ocupacion);
        {#                                bootbox.alert("Cambios guardados!", function() {});#}
                                        $('.camposPlantilla').hide();
                                        $('.opcionHistorial').hide();
                                        $('#guardarPlantilla').hide();
                                        {#alertify.success("Cambios guardados!");#}
                                        swal('','Cambios guardados!','success');
                                    }
                                    else{
                                        $('.camposPlantilla').hide();
                                        $('.opcionHistorial').hide();
                                        $('.selectPlantilla').hide();
                                        $('.labelPlantilla').hide();

                                        $('#planOpciones').hide();
                                        {#$('#historialPrevPDF').hide();
                                        $('#historialPrevPDF').prev().hide();#}

                                        $('#dgplusbellebundle_consulta_plantilla').hide();
                                        $('#dgplusbellebundle_consulta_plantilla').next().hide();

                                        $('#guardarPlantilla').hide();
                                        {#alertify.success("Cambios guardados!");#}
                                        swal('','Cambios guardados!','success');
                                        console.log("otro mensaje");
                                    }
                                    {#console.log("pagina actual: "+data);
                                    console.log("Inicio de registro: "+data.inicioRegistro);#}
                                },
                            error: function (data) {
                                {#alertify.error("Hubo un error, intente de nuevo!");#}
                                $('#guardarPlantilla').show();
                                swal('','Hubo un error, intente de nuevo!','error');
                            }
                        });
                    }
                    else{
                        {#bootbox.alert("Debe ingresar una consulta primero!", function() {});#}
                        swal('','Ingrese una consulta!','error');
                        $('#guardarPlantilla').show();
                    }
                    
                }
                else{
                    
                    var id = $('#idPaciente').val();
                    var idConsulta = $('#idConsulta').val();

        {#            alert(direccion);#}
                    var valores = new Array();
                    var idParameters = new Array();
                    var idEstetica= $('#dgplusbellebundle_consulta_estetica').val();
                    console.log(idEstetica);
                    switch(parseInt(idEstetica)){
                        case 1:

                            $('.corporall').each(function(index,element){
                                var valor = $(this).val();
                                var ids = $(this).attr('id');
                                valores.push(valor);
                                idParameters.push(ids);
                            });

                            $('.classCorporal').each(function(index,element){
                                var valor = $(this).prop("checked");
                                var ids = $(this).attr('id');
                                valores.push(valor);
                                idParameters.push(ids);
                            });

                            console.log(valores);


                            break;
                        case 2:

                            $('.classCorporal').each(function(index,element){
                                var valor = $(this).prop("checked");
                                var ids = $(this).attr('id');
                                valores.push(valor);
                                idParameters.push(ids);
                            });

                            break;
                        case 3:

                            $('.cbotox').each(function(index,element){
                                var valor = $(this).val();
                                var ids = $(this).attr('id');
                                valores.push(valor);
                                idParameters.push(ids);
                            });
                            console.log(valores);
                            break;
                    }
            


                    if(idConsulta!=''){
                        
                        var i=0;
                        $('.cbotox').each(function(index,element){
                            var valorbotox = $(this).val();
                            
                            if(valorbotox == "") {
                                i++;
                            }
                            
                        });
                        
                        
                        if(i==0){
                            $.ajax({
                                data:{id:id,valores:valores,idConsulta:idConsulta,idParameters:idParameters,idEstetica:idEstetica
                                },

                                url:"{{path('admin_consulta_insert_plantilla')}}",

                                type: "post",
                                success: function (data) {
                                        //inicio = data.inicio++;
                                        if(data==0){
                                            {#var iTel='<i class="fa fa-phone"></i>';
                                            var dir='<i class="fa fa-map-marker fa-fw"></i>';
                                            var ocup = '<i class="fa fa-briefcase"></i>';
                                            $('#telefono').html(iTel+" "+telefono1);
                                            $('#direccionD').html(dir+" "+direccion);


                                            $('#nombrePaciente').html(nombres+" "+apellidos);
                                            $('#ocupacionPaciente').html(ocup+" "+ocupacion);#}
                                            //$('#idPlantilla').hide();
                                            //$('#camposPlantilla').hide();
                                            $('.opcionHistorial').hide();
                                            $('#guardarPlantilla').hide();

                                            {#alertify.success("Plantilla guardada!");#}
                                            swal('','Plantilla guardada!','success');

                                        }
                                        else{
                                            $('.camposPlantilla').hide();
                                            $('.opcionHistorial').hide();
                                            $('.selectPlantilla').hide();
                                            $('.labelPlantilla').hide();

                                            $('#planOpciones').hide();
                                            {#$('#historialPrevPDF').hide();
                                            $('#historialPrevPDF').prev().hide();#}

                                            $('#dgplusbellebundle_consulta_plantilla').hide();
                                            $('#dgplusbellebundle_consulta_plantilla').next().hide();

                                            $('#guardarPlantilla').hide();
                                            {#alertify.success("Cambios guardados!");#}
                                            swal('','Cambios guardados!','success');
{#                                            console.log("otro mensaje");#}
                                        }

                                        {#console.log("pagina actual: "+data);
                                        console.log("Inicio de registro: "+data.inicioRegistro);#}
                                    },
                                error: function (data) {
                                    $('#guardarPlantilla').show();

                                }
                            });
                        }
                        else{
                            {#bootbox.alert('No debe de dejar en blanco ningun detalle de consulta de botox');#}
                            swal('','No debe dejar en blanco ningún detalle de consulta de botox!','error');
                            $('#guardarPlantilla').show();
                        }
                            
                    }
                    else{
                        {#bootbox.alert("Debe ingresar una consulta primero!", function() {});#}
                        swal('','Debe ingresar una consulta primero!','error');
                        $('#guardarPlantilla').show();
                    }
                }
        });
        
        
        $(document).on('click','#editarPlantilla', function(){
            var id = $('#idPaciente').val();
            var idConsulta = $('#idConsulta').val();
            var valores = new Array();
            var idParameters = new Array();
//            var idPlantilla= $('#dgplusbellebundle_consulta_plantilla').val();
            var idPlantilla = 0;
            
            {% if tipoPlantilla == 1 %}
                idPlantilla = {{ tienePlantilla[0].detallePlantilla.plantilla.id }}
            {% endif %}
        
            $('.classPlantilla').each(function(index,element){
                var valor = $(this).val();
                var ids = $(this).attr('id');
                valores.push(valor);
                idParameters.push(ids);                
            });
            
            var idConsulta = $('#idConsulta').val();

            var valores = new Array();
            var idParameters = new Array();
            //var idEstetica= $('#dgplusbellebundle_consulta_estetica').val();
            var idEstetica= {{ tipoPlantilla }};
            var id = $('#idPaciente').val();
                
            //console.log(idEstetica);
            switch(idEstetica){
                case 1:
                    $('.classPlantilla').each(function(index,element){
                        var valor = $(this).val();
                        var ids = $(this).attr('id');
                        valores.push(valor);
                        idParameters.push(ids);
                    });

                    break;
                case 3:
                    $('.corporall').each(function(index,element){
                        var valor = $(this).val();
                        var ids = $(this).attr('id');
                        valores.push(valor);
                        idParameters.push(ids);
                    });

                    $('.classCorporal').each(function(index,element){
                        var valor = $(this).prop("checked");
                        var ids = $(this).attr('id');
                        valores.push(valor);
                        idParameters.push(ids);
                    });

                    console.log(valores);
                    break;
                case 4:
                    $('.classCorporal').each(function(index,element){
                        var valor = $(this).prop("checked");
                        var ids = $(this).attr('id');
                        valores.push(valor);
                        idParameters.push(ids);
                    });

                    break;
                case 2:
                    $('.cbotox').each(function(index,element){
                        var valor = $(this).val();
                        var ids = $(this).attr('id');
                        valores.push(valor);
                        idParameters.push(ids);
                    });
                    console.log(valores);
                    break;
            }

                if(idConsulta!=''){
                    var i=0;
                    $('.cbotox').each(function(index,element){
                        var valorbotox = $(this).val();

                        if(valorbotox == "") {
                            i++;
                        }
                    });

                    if(i==0){
                        $.ajax({
                            data:{id:id,valores:valores,idConsulta:idConsulta,idParameters:idParameters,idEstetica:idEstetica, idPlantilla:idPlantilla
                            },

                            url:"{{path('admin_consulta_edit_plantilla')}}",

                            type: "post",
                            success: function (data) {
                                    //inicio = data.inicio++;
                                    if(data==0){
                                        $('#camposPlantilla').hide();
                                        $('.opcionHistorial').hide();
                                        $('#guardarPlantilla').hide();

                                        {#alertify.success("Plantilla guardada!");#}
                                        swal('','Plantilla guardada!','success');

                                    }
                                    else{
//                                        $('.camposPlantilla').hide();
                                        $('.opcionHistorial').hide();
                                        $('.selectPlantilla').hide();
                                        $('.labelPlantilla').hide();

                                        $('#planOpciones').hide();
                                        $('#historialPrevPDF').hide();
                                        $('#historialPrevPDF').prev().hide();

                                        $('#dgplusbellebundle_consulta_plantilla').hide();
                                        $('#dgplusbellebundle_consulta_plantilla').next().hide();

//                                        $('#guardarPlantilla').hide();
                                        {#alertify.success("Cambios guardados!");#}
                                        swal('','Cambios guardados!','success');
                                        {#console.log("otro mensaje");#}
                                    }

                                    {#console.log("pagina actual: "+data);
                                    console.log("Inicio de registro: "+data.inicioRegistro);#}
                                },
                            error: function (data) {


                            }
                        });
                    }
                    else{
                        {#bootbox.alert('No debe de dejar en blanco ningun detalle de consulta de botox');#}
                        swal('','No debe dejar en blanco ningun detalle de consulta de botox!','error');
                    }

                }
                else{
                    {#bootbox.alert("Debe ingresar una consulta primero!", function() {});#}
                    swal('','Debe ingresar una consulta primero!','error');
                }            
        });
        
        
        
        $(document).on("click","#guardarImagenes",function(){
        $("#prev").show();
        
        $("#saveImagen").hide();
        
        //obtenemos un array con los datos del archivo
        var file = $('#file-input')[0].files[0];
        //obtenemos el nombre del archivo
        var idconsulta =$('#idConsulta').val();
        var fileName = file.name;
        //obtenemos la extensión del archivo
        fileExtension = fileName.substring(fileName.lastIndexOf('.') + 1);
        //obtenemos el tamaño del archivo
        var fileSize = file.size;
        
        //obtenemos el tipo de archivo image/png ejemplo
        var fileType = file.type;
        console.log(fileType);
        console.log(fileExtension);
        if(idconsulta!=''){
            if (fileExtension == 'PNG' || fileExtension == 'png' ||fileExtension == 'JPG'|| fileExtension == 'jpg' && fileType =='imagen' || fileType =='image' || fileType =='image/jpeg' )
            {
                flag = true;
            }else{
                flag = false;
            }

                    if (flag==false){
                        alert("Archivo invalido, seleccione una imagen ");
                        $("#file-input").val("");
                        $("#prev").hide();
                        $("#saveImagen").hide();


                    }else{  

                         var pesoKb=(fileSize/1024);
                         if (pesoKb<=1024){
                            var frm = new FormData($("#formImagen")[0]);
                            console.log(frm);
                                 if (flag != false) {
                                    $.ajax({
                                    data:frm,
                                    url:Routing.generate('ingresar_foto_persona'),
                                    type: 'POST',
                                    dataType: 'json',

                                    cache: false,
                                    contentType: false,
                                    processData: false,

                                    success: function(data){
                                        $("#prev").attr('src', "/abgsistema/web/"+data.direccion);
                                        $('#file-input').val('');
                                        {#alertify.success("Imagenes guardadas!");#}
                                        swal('','Imágenes guardadas!','success');
                                        {#console.log(data);
                                        console.log(data.length);#}
                                        for(i=0;i<data.length;i++){
{#                                            $('#listadoImagenes').append('<div class=\"col-md-2\"><a class=\"verImagen\" href=\"{{ asset('Photos/Tmp/')}}'+data[i][1]+'\">Imagen '+(data[i][0]+(i+1))+' </a></div>');#}
                                            $('#listadoImagenes').append('<div style=\"margin-top:10px;\"  class=\"col-md-2\"><a class=\"verImagen\" href=\"{{ asset('Photos/Tmp/')}}'+data[i][1]+'\"><img style=\"width:100%;\" src=\"{{ asset('Photos/Tmp/')}}'+data[i][1]+'\"></a></div>');
                                        }
                                    },
                                    error: function(data){
                                        {#bootbox.alert('Hubo un error al subir las fotos');#}
                                        swal('','Hubo un error al subir las fotos!','error');
                                    }
                                });
                                }
                            }
                            else{
                                console.log(pesoKb);
{#                                bootbox.alert('Imagen demasiado grande, intente con una mas pequeña');#}
                                swal('','Imagen demasiado grande, intente con una más pequeña!','error');
                                //alert("Imagen demasiado grande, intente con una mas pequeña");
                            }
                    }

        }
        else{
            {#bootbox.alert('Debe ingresar una consulta antes de subir fotos!');#}
            swal('','Debe ingresar una consulta antes de subir fotos!','error');
        }
        });
        
        $(document).on('click', '.verImagen', function(){
            var url = $(this).attr('href');
            window.open(url, "_blank");
            return false;
        });
        
        $(document).on('click','#guardarReceta', function(){
            var id = $('#idPaciente').val();
            var idConsulta = $('#idConsulta').val();
            var valores = new Array();
{#            alert(direccion);#}
            if(id===''){
                swal('','Debe seleccionar un paciente','error');
                return false;
            }
            var nombre=$('#idPaciente').val();
{#            var id=12;#}
            var medico = $('#medico_consulta').val();
            var id = 0;
            $('#guardarReceta').hide();
            
            if(medico==3){ //dra.
                id = 13;
            }
            else{   //dr.
                id =12;
            }
            console.log(id);
            console.log("nombre: "+nombre);
            
            var valor = 0;
            valor = $('#receta').val();
            valores.push(valor);
            console.log(valores);
                
                        //alert(fechaNacimiento);
            
{#            url:"{{path('admin_consulta_insert_plantilla',{'id':id})}},#}
            //alert(idConsulta);
            if(idConsulta!=''){
                $.ajax({
                    data:{id:id,valores:valores,idConsulta:idConsulta
                    },
                    url:"{{path('admin_receta_guardar_ajax')}}",
                    type: "post",
                    success: function (data) {
                            //inicio = data.inicio++;
                            if(data==0){
                                $('#guardarReceta').show();
                                {#var iTel='<i class="fa fa-phone"></i>';
                                var dir='<i class="fa fa-map-marker fa-fw"></i>';
                                var ocup = '<i class="fa fa-briefcase"></i>';
                                $('#telefono').html(iTel+" "+telefono1);
                                $('#direccionD').html(dir+" "+direccion);
                                $('#nombrePaciente').html(nombres+" "+apellidos);
                                $('#ocupacionPaciente').html(ocup+" "+ocupacion);
{#                                bootbox.alert("Cambios guardados!", function() {});#}
                            {#alertify.success("Cambios guardados!");#}
                            }
                            else{
                                {#alertify.success("Receta guardada!");#}
                                swal('','Receta guardada!','success');
                                $('#receta').hide();
                            }
                            {#console.log("pagina actual: "+data);
                            console.log("Inicio de registro: "+data.inicioRegistro);#}
                                    },
                    error: function (data) {
                        {#alertify.error("Hubo un error, intente de nuevo!");#}
                        swal('','Hubo un error, intente de nuevo!','error');
                        $('#guardarReceta').show();
                        $('#receta').show();
                    }
                });
            }
            else{
                {#bootbox.alert("Debe ingresar una consulta antes!", function() {});#}
                swal('','Debe ingresar una consulta antes!','error');
                $('#guardarReceta').show();
                $('#receta').show();
            }
            return false;
        });
        
        
        
        
        
        
        /******************
         * Fin de metodos de guardar con ajax
         */
        
        
        $('#dgplusbellebundle_consulta_paciente').select2({
            ajax: {
                url: "{{path('busqueda_paciente_select')}}",
                dataType: 'json',
                delay: 250,
                data: function (params) {
                  return {
                    q: params.term, 
                    page: params.page
                  };
                },
                processResults: function (data, params) {
                    var select2Data = $.map(data.data, function (obj) {
                        obj.id = obj.tratamientoid;
                        obj.text = obj.nombre;

                        return obj;
                    });
                  
                    return {
                        results: select2Data
                        {#pagination: {
                            more: (params.page * 30) < data.total_count
                        }#}
                    };
                },
                cache: true
            },
            escapeMarkup: function (markup) { return markup; }, 
            minimumInputLength: 1,
            templateResult: formatRepo, 
            templateSelection: formatRepoSelection 
        });
        
        
        $('#tipo_consulta').select2();
        $('#medico_consulta').select2();
        $('#sucursal_consulta').select2();
        
        $('#selectPlantillas').select2();
        
        $('#estadoCivil').select2();
        $('#sexo').select2();
        
        $('#dgplusbellebundle_consulta_tratamiento').select2();
        $('#dgplusbellebundle_consulta_tipoConsulta').select2();
        $('#dgplusbellebundle_consulta_tipoConsulta').select2();
        $('#dgplusbellebundle_consulta_sucursal').select2();
        $('#dgplusbellebundle_consulta_plantilla').select2();
        $('#dgplusbellebundle_consulta_plantilla').val('');
        $('#dgplusbellebundle_consulta_estetica').select2();
        $('#dgplusbellebundle_consulta_estetica').val('');
        $("#dgplusbellebundle_consulta_pacienteSelectBoxItOptions li").remove();
        $("#dgplusbellebundle_consulta_reportePlantilla_1").prop("checked", true);
        $("#dgplusbellebundle_consulta_registraReceta_1").prop("checked", true);
        $("#lista_plantilla").hide();
        $("#lista_receta").hide();
        {#$('#dgplusbellebundle_consulta_fechaConsulta').daterangepicker({
                        singleDatePicker: true,
                        showDropdowns: true,
                        locale: {
                            format: 'YYYY-MM-DD'
                        },
                    });#}

        {#$('select[id$=dgplusbellebundle_consulta_placas_]').selectBoxIt();      #}
        var valores = new Array();
        var valores2 = new Array();
        var id=0;
        var nombre = 0;
        
        $(document).on('click','#historialPrevPDF',function(){
            valores = [];
{#            nombre=$('#dgplusbellebundle_consulta_paciente').val();#}
            nombre=$('#idPaciente').val();
            id=$('#dgplusbellebundle_consulta_plantilla').val();
            console.log(id);
            console.log("nombre: "+nombre);
            var valor = 0;
            $('.classPlantilla').each(function(index,element){
                valor = $(this).val();
                valores.push(valor);

            });
            var historial = $('#dgplusbellebundle_consulta_estetica').val();
            
            if(historial!=0{# && $('#dgplusbellebundle_consulta_reportePlantilla_0').is(':checked')#}){
           
            
                console.log(valores);
                var url = Routing.generate('admin_prevpdfplantilla_por_pdf', { nombre:nombre, id: id,valores:valores});
                console.log(url);

                window.open(url);
            }

            return false;
        });
        
        
        $('#tratamiento_consulta').select2({
                ajax: {
                    url: "{{path('busqueda_tratamiento_select')}}",
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                      return {
                        q: params.term,
                        page: params.page
                      };
                    },
                    processResults: function (data, params) {
                        var select2Data = $.map(data.data, function (obj) {
                            obj.id = obj.tratamientoid;
                            obj.text = obj.nombre;

                            return obj;
                        });

                        return {
                            results: select2Data
                        };
                    },
                    cache: true
                },
                escapeMarkup: function (markup) { return markup; },
                minimumInputLength: 1,
                templateResult: formatRepo,
                templateSelection: formatRepoSelection
            });
            
            
        
        // Si se hace click en ver vista previa en pdf de la consulta de estetica
        $(document).on('click','#esteticaPrevPDF',function(){
            var valores = [];
            var corporal = [];
            var botox = [];
            var abtx = 1;
            {#botox.push({
                item: []
            });#}
            var consulta_botox = [];
            var valor = 0;
           
            // Se obtiene el id del paciente
            var paciente = $('#idPaciente').val();
            
            //console.log(paciente);
            // Se obtiene el id de la sucursal seleccionada
            var sucursal = $('#sucursal_consulta').val();
            //alert(sucursal);
            // Se obtiene el id de la consulta de estetica seleccionada
            var estetica = $('#dgplusbellebundle_consulta_estetica').val();
            
            // Se obtiene la informacion ingresada acerca de lo que se ha seleccionado
            $('.classCorporal').each(function(index,element){
                if($(this).is(':checked')) { 
                    valor = $(this).val();
                    valores.push(valor);
                }
            });
            
            // Se obtiene la informacion ingresada acerca de la composicion corporal (peso, grasa corporal, ...)
            $('.corporall').each(function(index,element){
                valor = $(this).val();
                corporal.push(valor);
            });
            
            // Generacion del pdf dependiendo del tipo de consulta de estetica que ha seleccionado
            if(paciente != 0) {
                if(sucursal != "") {
                    // Si se ha seleccionado tipo de consulta corporal
                    if(estetica == 1) {
                        var url = Routing.generate('admin_prevpdfcorporal_por_pdf', { paciente:paciente, sucursal: sucursal, estetica:estetica, valores:valores, corporal:corporal});
                        window.open(url);
                    } 
                    // Si se ha seleccionado tipo de consulta facial
                    else if(estetica == 2) {
                        var url = Routing.generate('admin_prevpdf_facial_por_pdf', { paciente: paciente, sucursal: sucursal, valores: valores, estetica: estetica});
                        window.open(url);
                    } // Si se ha seleccionado tipo de consulta de botox
                    else if(estetica == 3) {
                        var idx = 0;
                        $('.cbotox').each(function(index,element){
                            valor = $(this).val();
                            
                            if(valor != "") {
                                botox.push(valor);
                            } else {
                                abtx = 0;
                            }
                            
                        });
                        
                        if(abtx == 1){
                            var url = Routing.generate('admin_botox_por_pdf_previa', { paciente:paciente, sucursal: sucursal, estetica:estetica, corporal:corporal, botox: botox});
                            window.open(url);
                        } else { 
                            {#bootbox.alert('No debe de dejar en blanco ningun detalle de consulta de botox');#}
                            swal('','No debe de dejar en blanco ningun detalle de consulta de botox!','error');
                        }
                    }else {
                        {#bootbox.alert('No se ha seleccionado una opción en el tipo de consulta de estetica');#}
                        swal('','No se ha seleccionado una opción en el tipo de consulta de estetica!','error');
                    }
                } else {
                    {#bootbox.alert('No se ha seleccionado una sucursal');#}
                    swal('','No se ha seleccionado una sucursal!','error');
                }
            } else {
                {#bootbox.alert('No se ha seleccionado un paciente');#}
                swal('','No se ha seleccionado un paciente!','error');
            }
            
            return false;
        });
        
        $(document).on('click','#recetaPrevPDF',function(){
            valores2 = [];
            var nombre=$('#idPaciente').val();
{#            id=$('#dgplusbellebundle_consulta_sesiontratamiento').val();#}
            var medico = $('#medico_consulta').val();
            var id = 0;
            if(medico==3){ //dra.
                id = 13;
            }
            else{   //dr.
                id =12;
            }
            console.log(id);
            var valor = 0;
            $('#receta').each(function(index,element){
                valor = $(this).val();
                valores2.push(valor);

            });
            var historial = $('#dgplusbellebundle_consulta_sesiontratamiento').val();
            if(historial!=0){
           
            
                console.log(valores2);
                var url = Routing.generate('admin_prevpdfreceta_por_pdf', { nombre:nombre, id: id,valores:valores2});
                console.log(url);

                window.open(url);
            }

            return false;
        });
        
        
        // Si se hace click en ver vista previa en pdf del comparativo de lectura 
        // de composicion corporal de consulta de estetica
        $(document).on('click','#urlComparativoCrp',function(){
            var corporal = [];
            var valor = 0;
           
            // Se obtiene el id del paciente
            var paciente = $('#idPaciente').val();
            //console.log(paciente);
            // Se obtiene el id de la sucursal seleccionada
            var sucursal = $('#sucursal_consulta').val();
            
            // Se obtiene el id de la consulta de estetica seleccionada
            var estetica = $('#dgplusbellebundle_consulta_estetica').val();
            
            // Se obtiene la informacion ingresada acerca de la composicion corporal (peso, grasa corporal, ...)
            $('.corporall').each(function(index,element){
                valor = $(this).val();
                corporal.push(valor);
            });
            
            // Generacion del pdf del tipo de consulta de estetica corporal
            if(paciente != 0) {
                if(sucursal != "") {
                    // Si se ha seleccionado tipo de consulta corporal
                    if(estetica == 1) {
                        var url = Routing.generate('admin_comparativo_corporal_por_pdf', { paciente:paciente, sucursal: sucursal, estetica:estetica, corporal:corporal});
                        window.open(url);
                    } 
                    // Si no se ha seleccionado tipo de consulta corporal
                    else  {
                        {#bootbox.alert('No se ha seleccionado la opción de tipo de consulta de estetica corporal');#}
                        swal('','No se ha seleccionado la opcion de tipo de consulta de estetica corporal!','error');
                    }
                } else {
                    {#bootbox.alert('No se ha seleccionado una sucursal');#}
                    swal('','No se ha seleccionado una sucursal!','error');
                }
            } else {
                {#bootbox.alert('No se ha seleccionado un paciente');#}
                swal('','No se ha seleccionado un paciente!','error');
            }
            
            return false;
        });
       
        // Nuevo registro de detalle de consulta de estetica de Botox
        $(document).on('click','#nuevoUrlBotox',function(){
            mostrarCamposBotox();
        });
        
        // Borrar registro de detalle de consulta de estetica de Botox
        $(document).on('click','.borrarRegistro',function(){
            // Se obtiene el id del link que se ha hecho click
            id = $(this).attr('id');
            
            var actualElem = id.split("-");
            
            // Se obtiene todos elementos que contengan la clase comparativoBotox
            var elements1 = document.getElementsByClassName('comparativoBotox-' + actualElem[1]);
            var elements2 = document.getElementsByClassName('botox-' + actualElem[1]);
            
            // Se borran todos los elementohtmls que se encuentran en el div con id = campos
            //$('#campos div').html('');

            // Se borran todos los elementos que contengan la clase = parametro
            while(elements1.length > 0){
                elements1[0].parentNode.removeChild(elements1[0]);
            }
            
            while(elements2.length > 0){
                elements2[0].parentNode.removeChild(elements2[0]);
            }
        });
        
        // Si se hace click en ver vista previa en pdf del comparativo de consulta
        // de consulta de estetica de Botox
        $(document).on('click','#urlComparativoBotox',function(){
            var corporal = [];
            var valor = 0;
           
            // Se obtiene el id del paciente
            var paciente = $('#dgplusbellebundle_consulta_paciente').val();
            //console.log(paciente);
            // Se obtiene el id de la sucursal seleccionada
            var sucursal = $('#dgplusbellebundle_consulta_sucursal').val();
            
            // Se obtiene el id de la consulta de estetica seleccionada
            var estetica = $('#dgplusbellebundle_consulta_estetica').val();
            
            // Se obtiene la informacion ingresada acerca de la composicion corporal (peso, grasa corporal, ...)
            $('.corporall').each(function(index,element){
                valor = $(this).val();
                corporal.push(valor);
            });
            
            // Generacion del pdf del tipo de consulta de estetica de botox
            if(paciente != 0) {
                if(sucursal != "") {
                    // Si se ha seleccionado tipo de consulta de botox
                    if(estetica == 3) {
                        var url = Routing.generate('admin_comparativo_botox_por_pdf', { paciente:paciente, sucursal: sucursal, estetica:estetica, corporal:corporal});
                        window.open(url);
                    } 
                    // Si no se ha seleccionado tipo de consulta de botox
                    else  {
                        {#bootbox.alert('No se ha seleccionado la opción de tipo de consulta de estetica de botox');#}
                        swal('','No se ha seleccionado la opción de tipo de consulta de estetica de botox!','error');
                    }
                } else {
                    {#bootbox.alert('No se ha seleccionado una sucursal');#}
                    swal('','No se ha seleccionado una sucursal!','error');
                }
            } else {
                {#bootbox.alert('No se ha seleccionado un paciente');#}
                swal('','No se ha seleccionado un paciente!','error');
            }
            
            return false;
        });
        
        {#collectionHolder.find('li').each(function() {
            addTagFormDeleteLink($(this));
    });
    collectionHolder2.find('li').each(function() {
            addTagFormDeleteLink2($(this));
    });#}
    
                var seleccionado="";
                //Eliminar options del select de pacientes
               {# $('#dgplusbellebundle_consulta_paciente option').each(function(index, val) {
                    
                    seleccionado = $(this).attr('selected');
                    if (!seleccionado){
                        $(this).remove();
                    }
                });#}

    

    // add the "add a tag" anchor and li to the tags ul
    collectionHolder.append($newLinkLi);
    collectionHolder2.append($newLinkLi2);

    // count the current form inputs we have (e.g. 2), use that as the new
    // index when inserting a new item (e.g. 2)
    collectionHolder.data('index', collectionHolder.find(':input').length);
    collectionHolder2.data('index', collectionHolder2.find(':input').length);
    
    //Identificar que form esta activo
    /*var editar=$('div.placas').attr('id');
    if(editar!='editar_usuario'){*/
        //addTagForm(collectionHolder, $newLinkLi);   //Muestra un formulario en la carga de la página nuevo
        //a/ddTagForm2(collectionHolder2, $newLinkLi2);   //Muestra un formulario en la carga de la página nuevo
    //}
    


    $addTagLink.on('click', function(e) {
        // prevent the link from creating a "#" on the URL
        e.preventDefault();

        // add a new tag form (see next code block)
        addTagForm(collectionHolder, $newLinkLi);
        // $('.btn_radio').attr('name', 'rol_predet');
    });
    $addTagLink2.on('click', function(e) {
        // prevent the link from creating a "#" on the URL
        e.preventDefault();

        // add a new tag form (see next code block)
        //addTagForm2(collectionHolder2, $newLinkLi2);
        // $('.btn_radio').attr('name', 'rol_predet');
    });

 //validarConsulta();
    
});

{#
function addTagForm(collectionHolder, $newLinkLi) {
    // Get the data-prototype explained earlier
    var prototype = collectionHolder.data('prototype');

    // get the new index
    var index = collectionHolder.data('index');

    // Replace '__name__' in the prototype's HTML to
    // instead be a number based on how many items we have
    var newForm = prototype.replace(/__name__/g, index);

    // increase the index with one for the next item
    collectionHolder.data('index', index + 1);

    // Display the form in the page in an li, before the "Add a tag" link li
    var $newFormLi = $('<div class="col-md-12"></div>').append(newForm);
    $newLinkLi.before($newFormLi);
    


    // add a delete link to the new form
    addTagFormDeleteLink($newFormLi);
     validarConsulta();
    $('.btn_radio').click(function(event) {
        /* Act on the event */
        var id = $(this).attr('id');
        // alert(id);
        $('.btn_radio').prop('checked', false);
        $('#'+id).prop('checked', true);
        $('.btn_radio').removeClass('errorform');
    });
}


function addTagForm2(collectionHolder2, $newLinkLi2) {
    // Get the data-prototype explained earlier
    var prototype2 = collectionHolder2.data('prototype');

    // get the new index
    var index2 = collectionHolder2.data('index');

    // Replace '__name__' in the prototype's HTML to
    // instead be a number based on how many items we have
    var newForm2 = prototype2.replace(/__name__/g, index2);

    // increase the index with one for the next item
    collectionHolder2.data('index', index2 + 1);

    // Display the form in the page in an li, before the "Add a tag" link li
    var $newFormLi2 = $('<div class="col-md-12"></div>').append(newForm2);
    $newLinkLi2.before($newFormLi2);
    


    // add a delete link to the new form
    addTagFormDeleteLink2($newFormLi2);
     
    $('.btn_radio').click(function(event) {
        /* Act on the event */
        var id = $(this).attr('id');
        // alert(id);
        $('.btn_radio').prop('checked', false);
        $('#'+id).prop('checked', true);
        $('.btn_radio').removeClass('errorform');
    });
}


function addTagFormDeleteLink($tagFormLi) {
    var $removeFormA = $('<div class="col-md-1"><a class="link btn btn-danger" href="#">Eliminar</a></div>');
    $tagFormLi.append($removeFormA);

    $removeFormA.on('click', function(e) {
        // prevent the link from creating a "#" on the URL
        e.preventDefault();

        // remove the li for the tag form
        $('input[name="rol_predet"]:checked').each(function() {
            //$(this).val() es el valor del checkbox correspondiente
           // alert('chequeado'); 
           $('#hnr_sircimbundle_usuariotype_placas_0_usroPredeterminado').prop('checked', true);
        });

        $tagFormLi.remove();
        
    });
}



function addTagFormDeleteLink2($tagFormLi2) {
    var $removeFormA2 = $('<div class="col-md-1"><a class="link2 btn btn-danger" href="#">Eliminar</a></div>');
    $tagFormLi2.append($removeFormA2);

    $removeFormA2.on('click', function(e) {
        // prevent the link from creating a "#" on the URL
        e.preventDefault();

        // remove the li for the tag form
        $('input[name="rol_predet"]:checked').each(function() {
            //$(this).val() es el valor del checkbox correspondiente
           // alert('chequeado'); 
           $('#hnr_sircimbundle_usuariotype_placas_0_usroPredeterminado').prop('checked', true);
        });

        $tagFormLi2.remove();
        
    });
}
#}



$('#editar_usuario')
            .on('mouseover','div', function(){
                $(this).find('a.link').css('visibility','visible');
            })
            .on('mouseout','div', function(){ 
                $(this).find('a.link').css('visibility','hidden'); 
            });

$('#editar_usuario')
            .on('mouseover','li:first-child', function(){
                $(this).find('a.link').css('visibility','hidden');
            });


    
var editar=$('div.placas').attr('id');
if(editar!='editar_usuario'){
    // $('#hnr_sircimbundle_usuariotype_placas_0_usroPredeterminado').prop('checked', true);//Se carga el radiobutton seleccionado
}
    </script>
    <script>
        $(document).ready(function(){
            {#$('.caducidad').daterangepicker({
                singleDatePicker: true,
                showDropdowns: true,
                locale: {
                    format: 'YYYY-MM-DD'
                },
            }); #}
        });
    </script>
    {#<script src="//cdn.tinymce.com/4/tinymce.min.js"></script>
    <script>
        tinymce.init({ 
            selector:'.editorArea',
            menubar: false,
            toolbar: 'undo redo | bold italic'
        });
    </script>#}
{% endblock %} 
